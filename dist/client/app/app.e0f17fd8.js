"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}angular.module("pedaleswitchApp",["pedaleswitchApp.auth","pedaleswitchApp.admin","pedaleswitchApp.constants","ngCookies","ngResource","ngSanitize","btford.socket-io","ui.router","ui.bootstrap","validation.match","color.picker","jdFontselect"]).config(["$urlRouterProvider","$locationProvider",function(a,b){a.otherwise("/"),b.html5Mode(!0)}]),angular.module("pedaleswitchApp.admin",["pedaleswitchApp.auth","ui.router"]),angular.module("pedaleswitchApp.auth",["pedaleswitchApp.constants","pedaleswitchApp.util","ngCookies","ui.router"]).config(["$httpProvider",function(a){a.interceptors.push("authInterceptor")}]),angular.module("pedaleswitchApp.util",[]),angular.module("pedaleswitchApp").directive("droppable",["canvasControl","canvasDraw","instanceDessin",function(a,b,c){return{link:function(d,e){var f=e[0];f.addEventListener("dragover",function(a){return a.dataTransfer.dropEffect="move",a.preventDefault&&a.preventDefault(),this.classList.add("over"),!1},!1),f.addEventListener("dragenter",function(a){return this.classList.add("over"),!1},!1),f.addEventListener("dragleave",function(a){return this.classList.remove("over"),!1},!1),f.addEventListener("drop",function(d){d.stopPropagation&&d.stopPropagation(),this.classList.remove("over");var e=JSON.parse(d.dataTransfer.getData("data")),f=c.searchEffetInDessin(e._id,e.key);if(f&&!f.inCanvas){var g={x:d.layerX,y:d.layerY};a.addToCanvas(f,!1,g),c.setBoite(a.getMasterBoite()),b.drawStuff()}return!1},!1)}}}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),SignupController=function(){function a(b,c){_classCallCheck(this,a),this.user={},this.errors={},this.submitted=!1,this.Auth=b,this.$state=c}return a.$inject=["Auth","$state"],_createClass(a,[{key:"register",value:function(a){var b=this;this.submitted=!0,a.$valid&&this.Auth.createUser({name:this.user.name,email:this.user.email,password:this.user.password}).then(function(){b.$state.go("main")})["catch"](function(c){c=c.data,b.errors={},angular.forEach(c.errors,function(c,d){a[d].$setValidity("mongoose",!1),b.errors[d]=c.message})})}}]),a}();angular.module("pedaleswitchApp").controller("SignupController",SignupController),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("addeffet",{url:"/addeffet",template:"<addeffet></addeffet>"}).state("addeffet.edit",{url:"/edit",template:"<editeffet></editeffet>",params:{entity:null,types:null,nouv:null}})}]),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("addeffet",{templateUrl:"app/addeffet/addeffet/addeffet.html",controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$http=c,this.entity=b.entity||{},this.types=b.types||{},this.nouv=b.nouv}return a.$inject=["$stateParams","$http"],_createClass(a,[{key:"addEffet",value:function(){if(this.entity.titre){for(var a={titre:this.entity.titre,description:this.entity.description,type:this.entity.type,options:[]},b=0;b<this.entity.options.length;b++)a.options.push(this.entity.options[b]);this.$http.post("/api/effets",a),this.entity.titre="",this.entity.description="",this.entity.type="",this.entity.options=[]}}},{key:"updateEffet",value:function(a){a._id&&this.$http.put("/api/effets/"+a._id,a)}},{key:"deleteEffet",value:function(a){a._id&&(this.$http["delete"]("/api/effets/"+a._id),this.entity={},this.nouv=!0)}},{key:"onAction",value:function(a){return a?void this.addEffet():void this.updateEffet(this.entity)}}]),a}();angular.module("pedaleswitchApp").component("editeffet",{templateUrl:"app/addeffet/editeffet/editeffet.html",controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d){_classCallCheck(this,a),this.message="Hello",this.$http=b,this.socket=d,this.indexEffets=[],c.$on("$destroy",function(){d.unsyncUpdates("effet")})}return a.$inject=["$http","$scope","socket"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/effets").then(function(b){a.indexEffets=b.data,a.socket.syncUpdates("effet",a.indexEffets)})}}]),a}();angular.module("pedaleswitchApp").component("effet",{templateUrl:"app/addeffet/effet/effet.html",bindings:{types:"="},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.message="Hello",this.$http=b,this.listeCompo=[],this.selectCompo=[],this.OrderArray=c}return a.$inject=["$http","OrderArray"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/composants").then(function(b){if(a.listeCompo=a.OrderArray.order(b.data,"type"),a.saved)for(var c in a.listeCompo)if(a.listeCompo.hasOwnProperty(c))for(var d=0;d<a.listeCompo[c].length;d++)a.saved.indexOf(a.listeCompo[c][d]._id)>=0&&(a.listeCompo[c][d].value=!0)})}},{key:"validation",value:function(){for(var a in this.listeCompo)if(this.listeCompo.hasOwnProperty(a))for(var b=0;b<this.listeCompo[a].length;b++)this.listeCompo[a][b].value===!0&&this.selectCompo.push(this.listeCompo[a][b]._id);this.ok({selected:this.selectCompo})}},{key:"annuler",value:function(){this.cancel()}}]),a}();angular.module("pedaleswitchApp").component("listeComposants",{templateUrl:"app/addeffet/listeComposants/listeComposants.html",controller:a,bindings:{ok:"&",cancel:"&",saved:"<"}})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$uibModalInstance=b,this.saved=c}return a.$inject=["$uibModalInstance","saved"],_createClass(a,[{key:"ok",value:function(a){this.$uibModalInstance.close(a)}},{key:"cancel",value:function(){this.$uibModalInstance.dismiss("cancel")}}]),a}();angular.module("pedaleswitchApp").controller("ModalBox",a)}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$http=b,this.modalServ=c,this.selected=[]}return a.$inject=["$http","$uibModal"],_createClass(a,[{key:"open",value:function(a){var b=this;this.modalInstance=this.modalServ.open({animation:!0,templateUrl:"app/addeffet/modalComposants/modalBox.html",controller:"ModalBox",controllerAs:"modal",resolve:{saved:function(){return b.oneComposant.available_compo_id}},size:a}),this.modalInstance.result.then(function(a){b.oneComposant.available_compo_id=a},function(){window.alert("Modal dismissed at: "+new Date)})}}]),a}();angular.module("pedaleswitchApp").component("modalComposants",{templateUrl:"app/addeffet/modalComposants/modalComposants.html",controller:a,bindings:{oneComposant:"="}})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b){_classCallCheck(this,a),this.$http=b,this.typeCompo={}}return a.$inject=["$http"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.nouvoption&&(this.oneOption.composants=[{titre:"A dÃ©finir"}]),this.$http.get("/api/composantTypes").then(function(b){a.typeCompo=b.data})}},{key:"newComposant",value:function(){this.oneOption.composants.push({titre:"nouveau composant"})}},{key:"deleteComposant",value:function(a){this.oneOption.composants.splice(a,1)}}]),a}();angular.module("pedaleswitchApp").component("optionComposants",{templateUrl:"app/addeffet/optionComposants/optionComposants.html",controller:a,bindings:{oneOption:"=",nouvoption:"<"}})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(){_classCallCheck(this,a),this.nouvoption=!1}return _createClass(a,[{key:"$onInit",value:function(){this.nouvEffet&&(this.effet.options=[{}],this.nouvoption=!0)}},{key:"newOption",value:function(){this.effet.options.push({titre:"nouvelle option"}),this.nouvoption=!0}},{key:"deleteOption",value:function(a){this.effet.options.splice(a,1)}}]),a}();angular.module("pedaleswitchApp").component("options",{templateUrl:"app/addeffet/options/options.html",controller:a,bindings:{effet:"=",nouvEffet:"<"}})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d){_classCallCheck(this,a),this.message="Hello",this.$http=b,this.socket=d,c.$on("$destroy",function(){d.unsyncUpdates("typeEffet")})}return a.$inject=["$http","$scope","socket"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/typeEffets").then(function(b){a.types=b.data,a.socket.syncUpdates("typeEffet",a.types)})}},{key:"addTypeEffet",value:function(){this.newTypeEffet.titre&&(this.$http.post("/api/typeEffets",{titre:this.newTypeEffet.titre}),this.newTypeEffet.titre="")}},{key:"deleteTypeEffet",value:function(a){this.$http["delete"]("/api/typeEffets/"+a._id)}},{key:"updateTypeEffet",value:function(a,b){this.$http.put("/api/typeEffets/"+a._id,{titre:b})}}]),a}();angular.module("pedaleswitchApp").component("addtype",{templateUrl:"app/addeffet/type/addtype.html",bindings:{types:"="},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b){_classCallCheck(this,a),this.users=b.query()}return a.$inject=["User"],_createClass(a,[{key:"delete",value:function(a){a.$remove(),this.users.splice(this.users.indexOf(a),1)}}]),a}();angular.module("pedaleswitchApp.admin").controller("AdminController",a)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};angular.module("pedaleswitchApp").factory("OrderArray",function(){return{order:function(a,b){var c={};return a.forEach(function(a,c,d){"undefined"!=typeof this[a[b]]?this[a[b]].push(a):(this[a[b]]=[],this[a[b]][0]=a)},c),c},boucle:function(a,b,c,d,e){var f,g,h;if("undefined"==typeof e&&(e=!0),e&&(this.path=[],this.pathok=[],this.ok=!1,this.deep=0),"object"!==("undefined"==typeof a?"undefined":_typeof(a))&&null!==a)return 0;if(this.ok===!0||this.deep>d)return this.pathok;for(f=Object.keys(a),g=f.length,h=0;g>h;++h){if(a[b]===c)return this.path[this.deep]=b,this.ok=!0,this.pathok=this.path.slice(0,this.deep+1),this.pathok;"object"===_typeof(a[f[h]])&&(this.path[this.deep]=f[h],this.deep++,this.boucle(a[f[h]],b,c,d,!1))}return this.deep--,0===this.pathok.length?!1:this.pathok},supwithpath:function(a,b){for(var c=a,d=0;null!==c&&d<b.length-1;)c=c[b[d]],d++;c.splice(b[b.length-1],1)},returnsubarray:function(a,b){if("object"===("undefined"==typeof b?"undefined":_typeof(b))&&null!==b&&(b=b.join(".")),"undefined"==typeof a&&null!==a)return!1;var c=b.indexOf(".");return c>-1?this.returnsubarray(a[b.substring(0,c)],b.substr(c+1)):a[b]}}}),angular.module("pedaleswitchApp.admin").config(["$stateProvider",function(a){a.state("admin",{url:"/admin",templateUrl:"app/admin/admin.html",controller:"AdminController",controllerAs:"admin",authenticate:"admin"})}]),function(a,b){a.module("pedaleswitchApp.constants",[]).constant("appConfig",{userRoles:["guest","user","admin"]})}(angular);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b){_classCallCheck(this,a),this.instanceDessin=b}return a.$inject=["instanceDessin"],_createClass(a,[{key:"addEffet",value:function(){this.instanceDessin.setEffet(this.eff,this.op)}}]),a}();angular.module("pedaleswitchApp").component("bibCompoDesc",{templateUrl:"app/bibliotheque-compo/bib-compo-desc/bib-compo-desc.html",bindings:{items:"<",op:"<",eff:"<"},controller:a})}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("bibCompoItem",{templateUrl:"app/bibliotheque-compo/bib-compo-item/bib-compo-item.html",bindings:{options:"<",items:"<",selectoption:"="},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b){_classCallCheck(this,a),this.instanceDessin=b}return a.$inject=["instanceDessin"],_createClass(a,[{key:"addEffet",value:function(){this.instanceDessin.setEffet(this.eff,this.op)}}]),a}();angular.module("pedaleswitchApp").component("bibDescription",{templateUrl:"app/bibliotheque/bib-description/bib-description.html",bindings:{op:"<",eff:"<"},controller:a})}(),function(){var a=function b(){_classCallCheck(this,b),this.selecteffet={}};angular.module("pedaleswitchApp").component("bibEffet",{templateUrl:"app/bibliotheque/bib-effet/bib-effet.html",bindings:{effets:"<",chgmteffet:"&"},controller:a})}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("bibOption",{templateUrl:"app/bibliotheque/bib-option/bib-option.html",bindings:{options:"<",selectoption:"="},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$http=b,this.effets=[],this.selecteffet={},this.selectoption={},this.OrderArray=c}return a.$inject=["$http","OrderArray"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/effets").then(function(b){a.effets=a.OrderArray.order(b.data,"type")})}},{key:"chgmtEffet",value:function(a){this.selecteffet=a,this.selectoption=a.options[0]}}]),a}();angular.module("pedaleswitchApp").component("bibliotheque",{templateUrl:"app/bibliotheque/bibliotheque.html",controller:a})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("bibliotheque",{url:"/bibliotheque",template:"<bibliotheque></bibliotheque>"})}]),angular.module("pedaleswitchApp").factory("canvasControl",["canvasGeneration","canvasConversion","checkCollision","rulers",function(a,b,c,d){var e={},f={},g={ctx:{},canvas:{},canvasWindow:{},marginCanvas:b.convertToPixel(40),debrayable:!1,viewState:"up",isActive:"effet"},h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[],s=function(b){switch(b.itemInfo.shape){case"Rect":return a.newRect(b);case"Cercle":return a.newCercle(b);case"Poly":return a.newPoly(b);default:return console.log("Shape not match in canvasControl :"+b.shape),!1}};return{addToCanvas:function(b,d,j){if(d=d||!1,j=j||null,!b.inCanvas||d){var k,l=a.newRect(b),m=b.composants;j&&(l.moveTo(j),g.debrayable&&l.resetCompPos()),"Boite"!==e.constructor.name?(this.setMasterBoite(a.newMasterBoite(l)),f.createProjection(),this.setBoite(f.projections[g.viewState]),l.moveCloseBorder(g.canvas,g.marginCanvas,e.margin),e.initMoveBox(l),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"))):(l.moveCloseBorder(g.canvas,g.marginCanvas,e.margin),f.checkBorderBoite(g.viewState,l),this.setArrowPos()),f.projections[g.viewState].effets.push(l);for(var n=0;n<m.length;n++)k=s(m[n]),i.push(k),l.composants.push(k),f.projections[g.viewState].composants.push(k);return b.inCanvas||l.resetCompPos(),b.inCanvas=!0,h.push(l),l.moveCloseBorder(g.canvas,g.marginCanvas,e.margin),c.checkAll(h),f.createProjectionsLimits(g.viewState),l}},removeToCanvas:function(a){var b=this.searchTabByIdReturnIndex(h,a._id,a.key);if(b!==!1){a.inCanvas=!1;for(var c=[],d=0;d<i.length;d++)a.key===i[d].key&&c.push(d);for(d=c.length-1;d>=0;d--)i.splice(c[d],1);h.splice(b,1)}},canvasViewState:function(b){switch(f.updateMaster(g.viewState),b){case"top":this.setViewState("top"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.top),this.setTableEffet(f.projections.top.effets),this.setTableComposant(f.projections.top.composants),this.setTableText(f.projections.top.textDeco),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"));break;case"bottom":this.setViewState("bottom"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.bottom),this.setTableEffet(f.projections.bottom.effets),this.setTableComposant(f.projections.bottom.composants),this.setTableText(f.projections.bottom.textDeco),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"));break;case"up":this.setViewState("up"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.up),this.setTableEffet(f.projections.up.effets),this.setTableComposant(f.projections.up.composants),this.setTableText(f.projections.up.textDeco),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"));break;case"down":this.setViewState("down"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.down),this.setTableEffet(f.projections.down.effets),this.setTableComposant(f.projections.down.composants),this.setTableText(f.projections.down.textDeco),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"));break;case"left":this.setViewState("left"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.left),this.setTableEffet(f.projections.left.effets),this.setTableComposant(f.projections.left.composants),this.setTableText(f.projections.left.textDeco),p.push(a.newArrowPoint(e,"right")),p.push(a.newArrowPoint(e,"bottom"));break;case"right":this.setViewState("right"),f.updateProjection(g.viewState),f.createProjectionsLimits(g.viewState),f.projections[g.viewState].moveToCenterWindow(g),this.resetAll(),this.setBoite(f.projections.right),this.setTableEffet(f.projections.right.effets),this.setTableComposant(f.projections.right.composants),this.setTableText(f.projections.right.textDeco),p.push(a.newArrowPoint(e,"right")),p.push(a.newArrowPoint(e,"bottom"));break;default:return console.log("ERROR "+b+" is not a valid state")}},canvasDrawState:function(a){var b,c;switch(a){case"effet":return b=h,c=i,this.resetIsSelected(b),this.resetIsSelected(c),this.resetTableDrawDashed(),this.setTableActive(b),this.setTableDrawThin(c),b.length>0;case"composant":return b=i,c=h,this.resetIsSelected(b),this.resetIsSelected(c),this.resetTableDrawThin(),this.setTableActive(b),this.setTableDrawDashed(c),b.length>0;case"deco":return this.resetIsSelected(i),this.resetIsSelected(h),this.resetTableDrawDashed(),this.resetTableDrawThin(),this.setTableActive(o),this.setTableDrawThin(i),o.length>0;default:return console.log("ERROR "+a+" is not a valid state")}},restoreCanvas:function(b){e=a.newBoite(),e.initBoiteWithBoite(b.boite),e.effets=h,b.boite=e,this.resizeCanvas(),p.push(a.newArrow(e,"right")),p.push(a.newArrow(e,"bottom"));for(var c=0;c<b.options.length;c++)b.options[c].inCanvas===!0&&this.addToCanvas(b.options[c],!0)},resizeCanvas:function(){if("Boite"===e.constructor.name){var a=150,c=b.getCanvasSize(),d=e.findExtreme();g.canvas.width=Math.max(d.r+a,c.w),g.canvas.height=Math.max(d.b+a,c.h)}},centerInCanvas:function(){e.points&&e.moveToCenterWindow(g)},checkBorderBoxRotate:function(a){var b,c=a.fonction;"effet"===c&&(f.checkBorderBoite(g.viewState,a),b=e.moveCloseBorder(g.canvas,g.marginCanvas),e.moveEffetCompo(b))},addTextToCanvas:function(b,c){var d,e;e=c||{x:400,y:400},d=a.newTexte(b),d.moveTo(e),f.projections[g.viewState].textDeco.push(d),o.push(d)},actualisePoints:function(a){a.actualisePoints()},getCanvasSetting:function(){return g},setCtx:function(a){g.ctx=a},setCanvas:function(a){var c=b.getCanvasSize();a.width=c.w,a.height=c.h,g.canvas=a},setCanvasWindow:function(a){var c=b.getCanvasSize();a.style.width=c.w.toString()+"px",a.style.height=c.h.toString()+"px",g.canvasWindow=a},setMarginCanvas:function(a){g.marginCanvas=a},setDeb:function(a){g.debrayable=a},setViewState:function(a){g.viewState=a},setIsActive:function(a){g.isActive=a},getTableText:function(){return o},setTableText:function(a){var b=o.length,c=a.length;o.splice(0,b);for(var d=0;c>d;d++)o.push(a[d]);return o},resetTableText:function(){o.splice(0,o.length)},setArrowPos:function(){for(var a=0;a<p.length;a++)p[a].setPos(p[a].loc)},resetCompPos:function(a){if(!a)for(var b=0;b<h.length;b++)h[b].resetCompPos()},resetIsSelected:function(a){for(var b=0;b<a.length;b++)a[b].isSelected=!1},updateComposantInCanvas:function(a){var b=this.searchEffetByKey(a.key);if(b){var c=this.searchTabByIdReturnIndex(h,b._id,b.key),d=this.searchTabByIdReturnIndex(h[c].composants,a._id,a.key),e=this.searchTabByIdReturnIndex(i,a._id,a.key);h[c].composants[d]=i[e]=s(a),h[c].composants[d].changeShape()}},searchTabByIdReturnIndex:function(a,b,c){for(var d=0;d<a.length;d++)if(a[d]._id===b&&a[d].key===c)return d;return!1},searchEffetByKey:function(a){for(var b=0;b<h.length;b++)if(h[b].key===a)return h[b];return!1},searchEffetById:function(a,b){for(var c=0;c<h.length;c++)if(h[c]._id===a&&h[c].key===b)return h[c];return!1},searchCompoById:function(a,b){for(var c=0;c<i.length;c++)if(i[c]._id===a&&i[c].key===b)return i[c];return!1},getZoom:function(){return b.getZoomRatio()},setBoite:function(a){return e=a},getBoite:function(){return e},setMasterBoite:function(a){return f=a},getMasterBoite:function(){return f},setTableEffet:function(a){var b=h.length,c=a.length;h.splice(0,b);for(var d=0;c>d;d++)h.push(a[d]);return h},getTableEffet:function(){return h},resetTableEffet:function(){var a=h.length;h.splice(0,a)},setTableComposant:function(a){var b=i.length,c=a.length;i.splice(0,b);for(var d=0;c>d;d++)i.push(a[d]);return i},getTableComposant:function(){return i},resetTableComposant:function(){var a=i.length;i.splice(0,a)},setActiveItem:function(a){var b=q.length;return q.splice(0,b),q.push(a),q},getActiveItem:function(){return q},resetActiveItem:function(){var a=q.length;q.splice(0,a)},setTableAlignLine:function(a){return n=a},getTableAlignLine:function(){return n},resetTableAlignLine:function(){n=[]},setTableArrow:function(a){var b=p.length,c=a.length;p.splice(0,b);for(var d=0;c>d;d++)p.push(a[d]);return p},getTableArrow:function(){return p},resetTableArrow:function(){var a=p.length;p.splice(0,a)},setTableActive:function(a){j=a},getTableActive:function(){return j},resetTableActive:function(){j=[]},setTableDrawDashed:function(a){k=a},getTableDrawDashed:function(){return k},resetTableDrawDashed:function(){k=[]},setTableDrawLimits:function(a){r=a},getTableDrawLimits:function(){return r},resetTableDrawLimits:function(){r=[]},setTableDrawShine:function(a){for(var b=0;b<a.length;b++)a[b].isSelected=!0;m=a},getTableDrawShine:function(){return m},resetTableDrawShine:function(){for(var a=0;a<m.length;a++)m[a].isSelected=!1;m=[]},setTableDrawThin:function(a){c.checkAll(a),l=a},getTableDrawThin:function(){return l},resetTableDrawThin:function(){l=[]},resetAll:function(){e={},this.resetTableEffet(),this.resetTableComposant(),this.resetTableActive(),this.resetTableDrawDashed(),this.resetTableDrawThin(),this.resetTableDrawShine(),this.resetTableAlignLine(),this.resetTableArrow(),this.resetTableText()},drawRulers:function(){d.render(g.canvas,g.ctx,"#aaa","pixels",100)},drawGrid:function(){d.drawGrid(g.canvas,g.ctx)},tableState:function(){return{masterBoite:f,boite:e,tableEffet:h,tableComposant:i,tableActive:j,tableDrawDashed:k,tableDrawThin:l,tableDrawShine:m,tableArrow:p,tableText:o}}}}]),angular.module("pedaleswitchApp").factory("canvasConversion",["$window",function(a){var b=2,c=1,d=3/4.2,e=300,f=1,g=1,h=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c].x=Math.round(b*a[c].x),a[c].y=Math.round(b*a[c].y)},i=function j(a,b){if("MasterBoite"===a.fonction)a.margin=Math.round(b*a.margin),a.initialHeight=Math.round(b*a.initialHeight),a.size.d=Math.round(b*a.size.d),a.size.d1=Math.round(b*a.size.d1),a.size.d2=Math.round(b*a.size.d2),a.size.h=Math.round(b*a.size.h),a.size.w=Math.round(b*a.size.w),j(a.projections.bottom,b),j(a.projections.down,b),j(a.projections.left,b),j(a.projections.right,b),j(a.projections.top,b),j(a.projections.up,b);else if("Boite"===a.fonction){if(a.margin=Math.round(b*a.margin),h(a.points,b),0!==a.textDeco.length)for(var c=0;c<a.textDeco.length;c++)h(a.textDeco[c].points,b),a.textDeco[c].font.size=Math.round(b*a.textDeco[c].font.size)}else if(h(a.points,b),a.composants&&"Boite"!==a.fonction)for(var d=0,e=a.composants.length;e>d;d++)h(a.composants[d].points,b),h(a.composants[d].pointsDefault,b)};return{getCanvasSize:function(){return{w:a.innerWidth*d,h:a.innerHeight-e}},getCanvasCenterInWindow:function(){var a=this.getCanvasSize();return{x:a.w/2,y:a.h/2}},getZoomRatio:function(){return Math.round(100*g)},setZoom:function(a){var b=g+a;return b>.2&&2>=b?(f=g,g=b,!0):!1},convertToPixel:function(a){var d=b/c;return Math.round(g*d*a)},convertToMm:function(a){var d=a/g;return d=d/b/c,Math.round(d)},convertDessinToMm:function(a){var d=1/(c*g*b);i(a.boite,d);for(var e=0;e<a.options.length;e++)i(a.options[e],d)},convertDessinToPixel:function(a){var d=g*b*c;i(a.boite,d);for(var e=0;e<a.options.length;e++)i(a.options[e],d)},initializeEffetZoom:function(a){i(a,g)},convertEffetZoom:function(a){var b=g/f;i(a,b)},convertEffetSize:function(a){var d=b/c;i(a,d)}}}]),angular.module("pedaleswitchApp").factory("canvasDraw",["canvasControl",function(a){var b=a.getCanvasSetting(),c=null,d=[],e=[],f=[],g=[],h=function(a,b){b.isSelected&&(a.font="16px sans-serif",a.strokeStyle="#00bfff",a.fillStyle="#00bfff",a.shadowColor="#666",a.shadowOffsetX=1,a.shadowOffsetY=1,
a.shadowBlur=2)};return{drawTableDashed:function(b,c,d,f,g){if(e=a.getTableDrawDashed(),0!==e.length){b.save(),b.lineWidth=f,b.strokeStyle=c,b.setLineDash(g);for(var i=0;i<e.length;i++)b.save(),h(b,e[i]),e[i].drawCanvas(b),d&&(b.fillStyle=d,b.fill()),b.restore();b.restore()}},drawTableThin:function(b,c,d,e){if(f=a.getTableDrawThin(),0!==f.length){b.save(),b.lineWidth=e,b.strokeStyle=c;for(var g=0;g<f.length;g++)b.save(),h(b,f[g]),f[g].drawCanvas(b),d&&(b.fillStyle=d,b.fill()),b.restore();b.restore()}},drawTableActive:function(b,c,e,f){if(d=a.getTableActive(),0!==d.length){b.save(),b.lineWidth=f,b.strokeStyle=c;for(var g=0;g<d.length;g++)b.save(),h(b,d[g]),d[g].drawCanvas(b),e&&(b.fillStyle=e,b.fill()),b.restore();b.restore()}},drawBoite:function(b,d,e,f){c=a.getBoite(),"Boite"===c.fonction&&(b.save(),b.lineWidth=f,b.strokeStyle=d,b.shadowColor="#666",b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=2,c.drawCanvas(b),e&&(b.fillStyle=e,b.fill()),c.isOverlapping&&(b.fillStyle="rgba(255, 00, 00, 0.2)",b.fill()),b.restore())},drawTableAlignLine:function(b,c,d,e,f){var g,h=a.getTableAlignLine()||[];if(0!==h.length){for(c.save(),c.setLineDash(f),g=0;g<h.x.length;g++)c.strokeStyle=d,c.beginPath(),h.x[g].isPile&&(c.strokeStyle=e),c.moveTo(h.x[g].x,0),c.lineTo(h.x[g].x,b.height),c.stroke(),c.closePath();for(g=0;g<h.y.length;g++)c.strokeStyle=d,c.beginPath(),h.y[g].isPile&&(c.strokeStyle=e),c.moveTo(0,h.y[g].y),c.lineTo(b.width,h.y[g].y),c.stroke(),c.closePath();c.restore()}},drawArrow:function(b,c){var d=a.getTableArrow();if(0!==d.length){b.save(),b.shadowColor="gray",b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=1,b.fillStyle=c;for(var e=0;e<d.length;e++)d[e].drawCanvas(b);b.restore()}},drawText:function(b){var c=a.getTableText();if(0!==c.length)for(var d=0;d<c.length;d++)c[d].drawCanvas(b)},drawTableLimits:function(b,c,d,e,f){if(g=a.getTableDrawLimits(),0!==g.length){b.save(),b.lineWidth=e,b.strokeStyle=c,b.setLineDash(f);for(var i=0;i<g.length;i++)b.save(),h(b,g[i]),g[i].drawCanvasLimits(b),d&&(b.fillStyle=d,b.fill()),b.restore();b.restore()}},drawStuff:function(){b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height),this.drawBoite(b.ctx,"gray","#f6f6f6","1px"),this.drawTableDashed(b.ctx,"gray","#f6f6f6","1px",[10,3]),this.drawTableLimits(b.ctx,"gray","#f6f6f6","1px",[10,3]),this.drawTableThin(b.ctx,"gray",null,"1px"),this.drawTableAlignLine(b.canvas,b.ctx,"#d0d0d0","#00bfff",[10,3]),this.drawTableActive(b.ctx,"black",null,"1px"),this.drawArrow(b.ctx,"gray")}}}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();angular.module("pedaleswitchApp").factory("canvasGeneration",["canvasConversion",function(a){var b=function(){function a(b){_classCallCheck(this,a),this.x=b.x,this.y=b.y}return _createClass(a,[{key:"translate",value:function(a){this.x+=a.x,this.y+=a.y}},{key:"rotate",value:function(a,b){var c=a*(2*Math.PI)/360,d=Math.cos(c),e=Math.sin(c),f={};f.x=this.getX()-b.x,f.y=this.getY()-b.y,this.setX(f.x*d+f.y*e+b.x),this.setY(-f.x*e+f.y*d+b.y)}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"setX",value:function(a){this.x=a}},{key:"setY",value:function(a){this.y=a}}]),a}(),c=function(){function a(b){_classCallCheck(this,a),this._id=b._id||null,Number.isInteger(b.key)?this.key=b.key:this.key=null,this.titre=b.titre||null,this.titreOption=b.titreOption||null,this.titreParentEffet=b.titreParentEffet||null,this.titreParentOption=b.titreParentOption||null,this.description=b.description||null,this.descriptionOption=b.descriptionOption||null,this.composants=[],this.itemInfo=b.itemInfo||null,this.prix=b.prix||null,this.isSelected=!1,this.isOverlapping=!1,this.fonction=b.fonction||"effet",this.angle=b.angle||0,this.size={},this.posBox={},this.points=b.points,this.pointsDefault=b.pointsDefault||null,this.initPoints(b.points,this.points),this.initPoints(b.pointsDefault,this.pointsDefault),this.posBox=this.points[0]}return _createClass(a,[{key:"initPoints",value:function(a,c){if(a){var d,e=a.length,f=[];for(d=0;e>d;d++)f.push(new b(a[d]));for(c.splice(0,c.length),d=0;e>d;d++)c.push(f[d])}}},{key:"resetCompPos",value:function(){var a=this.composants;if(0!==a.length)for(var b=0;b<a.length;b++)for(var c=0;c<a[b].points.length;c++)a[b].points[c].x=this.points[0].x+a[b].pointsDefault[c].x,a[b].points[c].y=this.points[0].y+a[b].pointsDefault[c].y}},{key:"getArea",value:function(){for(var a=0,b=0,c=this.points.length;c-1>b;b++)a+=this.points[b].x*this.points[b+1].y-this.points[b+1].x*this.points[b].y;return a+=this.points[c-1].x*this.points[0].y-this.points[0].x*this.points[c-1].y,a/=2}},{key:"getCenter",value:function(){for(var a,b=this.getArea(),c=0,d=0,e=0,f=this.points.length;f-1>e;e++)a=this.points[e].x*this.points[e+1].y-this.points[e+1].x*this.points[e].y,c+=(this.points[e].x+this.points[e+1].x)*a,d+=(this.points[e].y+this.points[e+1].y)*a;return a=this.points[f-1].x*this.points[0].y-this.points[0].x*this.points[f-1].y,c+=(this.points[f-1].x+this.points[0].x)*a,d+=(this.points[f-1].y+this.points[0].y)*a,c/=6*b,d/=6*b,{x:c,y:d}}},{key:"getCenterX",value:function(){return this.getCenter().x}},{key:"getCenterY",value:function(){return this.getCenter().y}},{key:"moveTo",value:function(a){var b=this.getCenter(),c={x:a.x-b.x,y:a.y-b.y};this.move(c)}},{key:"move",value:function(a){for(var b=0,c=this.points.length;c>b;b++)this.points[b].translate(a)}},{key:"getBoxPos",value:function(){var a=this.getCenter(),b=this.findExtreme();return{x:a.x-b.size.w/2,y:a.y-b.size.h/2}}},{key:"findExtreme",value:function(){for(var a={t:1/0,r:-(1/0),b:-(1/0),l:1/0},b=function(a,b){a.t=Math.min(a.t,b.y),a.r=Math.max(a.r,b.x),a.b=Math.max(a.b,b.y),a.l=Math.min(a.l,b.x)},c=0,d=this.points.length;d>c;c++)b(a,this.points[c]);return a.size={w:a.r-a.l,h:a.b-a.t},this.size.w=a.size.w,this.size.h=a.size.h,a}},{key:"setSelected",value:function(a){this.isSelected=a}},{key:"setOverlapping",value:function(a){this.isOverlapping=a}},{key:"rotate",value:function(a,c,d){var e,f,g,h,i,j=new b(this.points[0]);for(d=d||!1,c=c||{x:this.getCenterX(),y:this.getCenterY()},e=0,f=this.points.length;f>e;e++)this.points[e].rotate(a,c);if(this.composants.length>0)if(d)for(e=0,f=this.composants.length;f>e;e++)for(g=0,h=this.composants[e].points.length;h>g;g++)i=new b(this.composants[e].pointsDefault[g]),i.setX(i.getX()+j.getX()-c.x),i.setY(i.getY()+j.getY()-c.y),i.rotate(a,{x:0,y:0}),i.setX(c.x+i.getX()-this.points[0].getX()),i.setY(c.y+i.getY()-this.points[0].getY()),this.composants[e].pointsDefault[g].setX(i.getX()),this.composants[e].pointsDefault[g].setY(i.getY());else for(e=0,f=this.composants.length;f>e;e++)for(this.composants[e].changeShape(),this.composants[e].angle+=a,g=0,h=this.composants[e].points.length;h>g;g++)this.composants[e].points[g].rotate(a,c),this.composants[e].pointsDefault[g].setX(this.composants[e].points[g].getX()-this.points[0].getX()),this.composants[e].pointsDefault[g].setY(this.composants[e].points[g].getY()-this.points[0].getY());this.angle+=a,this.changeShape(),this.findExtreme()}},{key:"changeShape",value:function(){"Rect"===this.constructor.name&&(this.angle%90===0?this.shapeObject="Rect":this.shapeObject="Poly")}},{key:"moveCloseBorder",value:function(a,b,c){c=c||0,b+=c;var d={x:0,y:0},e=this.findExtreme();return e.t<b&&(this.move({x:0,y:b-e.t}),d.y=b-e.t),e.l<b&&(this.move({x:b-e.l,y:0}),d.x=b-e.l),e.r+b+150>a.width&&(a.width=e.r+b+150),e.b+b+150>a.height&&(a.height=e.b+b+150),d}}]),a}(),d=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this,a));return c.shapeObject="Cercle",c}return _inherits(b,a),_createClass(b,[{key:"getRadius",value:function(){return Math.sqrt((this.points[0].x-this.points[1].x)*(this.points[0].x-this.points[1].x)+(this.points[0].y-this.points[1].y)*(this.points[0].y-this.points[1].y))/2}},{key:"drawCanvas",value:function(a){a.beginPath(),a.arc(this.getCenterX(),this.getCenterY(),this.getRadius(),0,2*Math.PI),a.fillRect(this.getCenterX(),this.getCenterY(),1,1),this.isOverlapping&&(a.fillStyle="rgba(255, 00, 00, 0.2)",a.fill()),a.stroke(),a.closePath()}}]),b}(c),e=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this,a));return c.shapeObject=a.shapeObject||"Rect",c}return _inherits(b,a),_createClass(b,[{key:"drawCanvas",value:function(a){a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y);for(var b=0,c=this.points.length;c>b;b++)a.lineTo(this.points[b].x,this.points[b].y);a.closePath(),a.stroke(),a.fillRect(this.getCenterX(),this.getCenterY(),1,1),this.isOverlapping&&(a.fillStyle="rgba(255, 00, 00, 0.2)",a.fill())}}]),b}(c),f=function(){function c(a,b){_classCallCheck(this,c),this.margin=a.margin,this.isSelected=!1,this.isOverlapping=!1,this.titre="Boite",this.effets=[],this.composants=[],this.points=[],this.textDeco=[],this.shapeDeco=[],this.imgDeco=[],this.shapeObject="Rect",this.fonction="Boite",this.initPoints(b.points,this.points)}return _createClass(c,[{key:"initPoints",value:function(a,c){if(a){var d,e=a.length,f=[];for(d=0;e>d;d++)f.push(new b(a[d]));for(c.splice(0,c.length),d=0;e>d;d++)c.push(f[d])}}},{key:"initMoveBox",value:function(a){var b=a.findExtreme(),c={x:b.l-this.margin,y:b.t-this.margin};this.move(c)}},{key:"move",value:function(a){for(var b=0,c=this.points.length;c>b;b++)this.points[b].translate(a)}},{key:"moveToCenterWindow",value:function(b){var c,d=a.getCanvasCenterInWindow(),e=this.getCenter(),f={x:d.x-e.x,y:d.y-e.y};this.move(f),c=this.moveCloseBorder(b.canvas,b.marginCanvas),f.x+=c.x,f.y+=c.y,this.moveEffetCompo(f)}},{key:"moveEffetCompo",value:function(a){var b,c,d,e,f,g,h;if(b=this.effets,c=this.textDeco,d=this.shapeDeco,e=this.imgDeco,0!==b.length)for(g=0;g<b.length;g++)if(b[g].move(a),f=b[g].composants,0!==f.length)for(h=0;h<f.length;h++)f[h].move(a);if(0!==c.length)for(g=0;g<c.length;g++)c[g].move(a)}},{key:"findAllExtreme",value:function(){var a,b,c,d,e,f={};if(f={t:1/0,r:-(1/0),b:-(1/0),l:1/0},e=function(a,b){a.t=Math.min(a.t,b.y),a.r=Math.max(a.r,b.x),a.b=Math.max(a.b,b.y),a.l=Math.min(a.l,b.x)},d=this.effets.length)for(a=0;d>a;a++)for(b=0,c=this.effets[a].points.length;c>b;b++)e(f,this.effets[a].points[b]);if(d=this.composants.length)for(a=0;d>a;a++)for(b=0,c=this.composants[a].points.length;c>b;b++)e(f,this.composants[a].points[b]);return f.size={w:f.r-f.l,h:f.b-f.t},f}},{key:"findExtreme",value:function(){for(var a={t:1/0,r:-(1/0),b:-(1/0),l:1/0},b=function(a,b){a.t=Math.min(a.t,b.y),a.r=Math.max(a.r,b.x),a.b=Math.max(a.b,b.y),a.l=Math.min(a.l,b.x)},c=0,d=this.points.length;d>c;c++)b(a,this.points[c]);return a.size={w:a.r-a.l,h:a.b-a.t},a}},{key:"getArea",value:function(){for(var a=0,b=0,c=this.points.length;c-1>b;b++)a+=this.points[b].x*this.points[b+1].y-this.points[b+1].x*this.points[b].y;return a+=this.points[c-1].x*this.points[0].y-this.points[0].x*this.points[c-1].y,a/=2}},{key:"getCenter",value:function(){for(var a,b=this.getArea(),c=0,d=0,e=0,f=this.points.length;f-1>e;e++)a=this.points[e].x*this.points[e+1].y-this.points[e+1].x*this.points[e].y,c+=(this.points[e].x+this.points[e+1].x)*a,d+=(this.points[e].y+this.points[e+1].y)*a;return a=this.points[f-1].x*this.points[0].y-this.points[0].x*this.points[f-1].y,c+=(this.points[f-1].x+this.points[0].x)*a,d+=(this.points[f-1].y+this.points[0].y)*a,c/=6*b,d/=6*b,{x:c,y:d}}},{key:"getCenterX",value:function(){return this.getCenter().x}},{key:"getCenterY",value:function(){return this.getCenter().y}},{key:"moveCloseBorder",value:function(a,b,c){c=c||0,b+=c;var d={x:0,y:0},e=this.findExtreme();return e.t<b&&(this.move({x:0,y:b-e.t}),d.y=b-e.t),e.l<b&&(this.move({x:b-e.l,y:0}),d.x=b-e.l),e.r+b+150>a.width&&(a.width=e.r+b+150),e.b+b+150>a.height&&(a.height=e.b+b+150),d}},{key:"setSelected",value:function(a){this.isSelected=a}},{key:"setOverlapping",value:function(a){this.isOverlapping=a}},{key:"drawCanvas",value:function(a){a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y);for(var b=0,c=this.points.length;c>b;b++)a.lineTo(this.points[b].x,this.points[b].y);a.closePath(),a.stroke()}},{key:"drawCanvasLimits",value:function(a){this.sizeProjMini.size.w>0&&(a.beginPath(),a.rect(this.sizeProjMini.l,this.sizeProjMini.t,this.sizeProjMini.size.w,this.sizeProjMini.size.h),a.closePath(),a.stroke())}}]),c}(),g=function(){function b(a){_classCallCheck(this,b),this.margin=5,this.initialHeight=80,this.convertMargin(),this.convertInitialHeight(),this.size={w:null,h:null,d:null,d1:this.initialHeight,d2:this.initialHeight},this.projections={up:null,down:null,left:null,right:null,top:null,bottom:null},this.fonction="MasterBoite",this.shapeObject="Rect",this.initBoiteWithEffect(a)}return _createClass(b,[{key:"setSide",value:function(a,b){this.size[a]=b}},{key:"getSide",value:function(a){return this.size[a]}},{key:"initBoiteWithEffect",value:function(a){var b=a.findExtreme(),c=b.size.h+2*this.margin,d=b.size.w+2*this.margin,e=this.getSide("d2")-this.getSide("d1");this.setSide("w",d),this.setSide("d",c),this.setSide("h",Math.sqrt(c*c-e*e))}},{key:"convertMargin",value:function(){this.margin=a.convertToPixel(this.margin)}},{key:"convertInitialHeight",value:function(){this.initialHeight=a.convertToPixel(this.initialHeight)}},{key:"projectionsCollisionY",value:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this.size.d2-this.size.d1,u=0,v=0,w=[];e=this.projections.up,f=this.projections.left,g=this.projections.right,h=this.projections.top,i=this.projections.bottom;var x=function(a,b){return Math.sqrt(a*a-b*b)},y=function(a,b){return Math.sqrt(a*a+b*b)};switch(a){case"up":if(s=(f.points[1].x-f.points[0].x)/(e.points[3].y-e.points[0].y-(b.y-e.points[c].y)),d=(b.y-e.points[c].y)*s,j=c-1>=0?c-1:3,0===j||3===j?(k=f.points[j].x+d,k>f.sizeProjMini.l-this.margin&&(e.setOverlapping(!0),v=Math.max(v,f.points[1].x-(f.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?f.points[1].x-b:b;f.points[0].setX(c||a),f.points[3].setX(c||a)}},w.push(l())):(k=f.points[j].x+d,k<f.sizeProjMini.r+this.margin&&(e.setOverlapping(!0),v=Math.max(v,f.sizeProjMini.r+this.margin-f.points[0].x)),l=function(){var a=k;return function(b){var c=b?f.points[0].x+b:b;f.points[1].setX(c||a),f.points[2].setX(c||a)}},w.push(l())),j=4>c+1?c+1:0,0===j||3===j?(k=g.points[j].x-d,k>g.sizeProjMini.l-this.margin&&(e.setOverlapping(!0),v=Math.max(v,g.points[1].x-(g.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?g.points[1].x-b:b;g.points[0].setX(c||a),g.points[3].setX(c||a)}},w.push(l())):(k=g.points[j].x-d,k<g.sizeProjMini.r+this.margin&&(e.setOverlapping(!0),v=Math.max(v,g.sizeProjMini.r+this.margin-g.points[0].x)),l=function(){var a=k;return function(b){var c=b?g.points[0].x+b:b;g.points[1].setX(c||a),g.points[2].setX(c||a)}},w.push(l())),0!==v){for(m in w)w[m](v);return y(v,t)}for(m in w)w[m]();return e.setOverlapping(!1),!1;case"left":if(q=f.points[1].y-f.points[0].y,p=q-(b.y-f.points[c].y),t=f.points[2].x-f.points[3].x,o=y(q,t),n=y(p,t),r=f.points[2].y-f.points[1].y,d=o-n,j=c,0!==j&&1!==j||(k=e.points[j].y+d,k>e.sizeProjMini.t-this.margin&&(f.setOverlapping(!0),v=e.points[3].y-(e.sizeProjMini.t-this.margin)),l=function(){var a=k;return function(b){var c=b?e.points[3].y-b:b;e.points[0].setY(c||a),e.points[1].setY(c||a)}},w.push(l())),d=b.y-f.points[c].y,0===j||1===j?(k=h.points[j].y+d,k>h.sizeProjMini.t-this.margin&&(f.setOverlapping(!0),p=h.points[3].y-(h.sizeProjMini.t-this.margin)-r,n=y(p,t),v=Math.max(v,n)),l=function(){var a=k;return function(b){var c=b?h.points[3].y-(x(b,t)+r):b;h.points[0].setY(c||a),h.points[1].setY(c||a)}},w.push(l())):(k=h.points[j].y+d,k<h.sizeProjMini.b+this.margin&&(f.setOverlapping(!0),v=Math.max(v,h.sizeProjMini.b+this.margin-h.points[0].y)),l=function(){var a=k;return function(b){var c=b?h.points[0].y+b:b;h.points[2].setY(c||a),h.points[3].setY(c||a)}},w.push(l())),2!==j&&3!==j||(k=i.points[j].y+d,k<i.sizeProjMini.b+this.margin&&(f.setOverlapping(!0),v=Math.max(v,i.sizeProjMini.b+this.margin-i.points[0].y+q)),l=function(){var a=k;return function(b){var c=b?i.points[0].y+(b-q):b;i.points[2].setY(c||a),i.points[3].setY(c||a)}},w.push(l())),0===j&&(k=g.points[1].y+d,l=function(){var a=k;return function(b){var c=b?g.points[2].y-(x(b,t)+r):b;g.points[1].setY(c||a)}},w.push(l())),2!==j&&3!==j||(k=g.points[j].y+d,k<g.sizeProjMini.b+this.margin&&(f.setOverlapping(!0),v=Math.max(v,g.sizeProjMini.b+this.margin-g.points[1].y)),l=function(){var a=k;return function(b){var c=b?g.points[1].y+b:b;g.points[2].setY(c||a),g.points[3].setY(c||a)}},w.push(l())),1===u){if(0!==v){for(m in w)w[m](v);return x(v,t)+r}for(m in w)w[m]();return f.setOverlapping(!1),!1}if(0!==v){for(m in w)w[m](v);return v}for(m in w)w[m]();return f.setOverlapping(!1),!1;case"right":if(q=g.points[0].y-g.points[1].y,p=q-(b.y-g.points[c].y),t=g.points[2].x-g.points[3].x,o=y(q,t),n=y(p,t),r=g.points[3].y-g.points[0].y,d=o-n,j=c,0!==j&&1!==j||(k=e.points[j].y+d,k>e.sizeProjMini.t-this.margin&&(g.setOverlapping(!0),v=e.points[3].y-(e.sizeProjMini.t-this.margin),u=1),l=function(){var a=k;return function(b){var c=b?e.points[3].y-b:b;e.points[0].setY(c||a),e.points[1].setY(c||a)}},w.push(l())),d=b.y-g.points[c].y,j=c,0===j||1===j?(k=h.points[j].y+d,k>h.sizeProjMini.t-this.margin&&(g.setOverlapping(!0),p=h.points[3].y-(h.sizeProjMini.t-this.margin)-r,n=y(p,t),v=Math.max(v,n),u=1),l=function(){var a=k;return function(b){var c=b?h.points[3].y-(x(b,t)+r):b;h.points[0].setY(c||a),h.points[1].setY(c||a)}},w.push(l())):(k=h.points[j].y+d,k<h.sizeProjMini.b+this.margin&&(g.setOverlapping(!0),v=Math.max(v,h.sizeProjMini.b+this.margin-h.points[0].y)),l=function(){var a=k;return function(b){var c=b?h.points[0].y+b:b;h.points[2].setY(c||a),h.points[3].setY(c||a)}},w.push(l())),2!==j&&3!==j||(k=i.points[j].y+d,k<i.sizeProjMini.b+this.margin&&(g.setOverlapping(!0),v=Math.max(v,i.sizeProjMini.b+this.margin-i.points[0].y+q)),l=function(){var a=k;return function(b){var c=b?i.points[0].y+(b-q):b;i.points[2].setY(c||a),i.points[3].setY(c||a)}},w.push(l())),1===j&&(k=f.points[0].y+d,l=function(){var a=k;return function(b){var c=b?f.points[3].y-(x(b,t)+r):b;f.points[0].setY(c||a)}},w.push(l())),2!==j&&3!==j||(k=f.points[j].y+d,k<f.sizeProjMini.b+this.margin&&(g.setOverlapping(!0),v=Math.max(v,f.sizeProjMini.b+this.margin-f.points[0].y)),l=function(){var a=k;return function(b){var c=b?f.points[0].y+b:b;f.points[2].setY(c||a),f.points[3].setY(c||a)}},w.push(l())),1===u){if(0!==v){for(m in w)w[m](v);return x(v,t)+r}for(m in w)w[m]();return g.setOverlapping(!1),!1}if(0!==v){for(m in w)w[m](v);return v}for(m in w)w[m]();return g.setOverlapping(!1),!1;case"top":return console.log('WARNING : "'+a+'" viewState is not yet implemented in box collision');case"bottom":return console.log('WARNING : "'+a+'" viewState is not yet implemented in box collision');default:return console.log("ERROR : "+a+" is not a valid state")}}},{key:"projectionsCollisionX",value:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=1,u=0,v=[],w=function(a,b){return Math.sqrt(a*a-b*b)},x=function(a,b){return Math.sqrt(a*a+b*b)};switch(e=this.projections.up,f=this.projections.left,g=this.projections.right,h=this.projections.top,i=this.projections.bottom,a){case"top":if(d=b.x-h.points[c].x,j=c-2>=0?c-2:c+2,0===j||3===j?(k=e.points[j].x-d,k>e.sizeProjMini.l-this.margin&&(h.setOverlapping(!0),u=Math.max(u,e.points[1].x-(e.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?e.points[1].x-b:b;e.points[0].setX(c||a),e.points[3].setX(c||a)}},v.push(l())):(k=e.points[j].x-d,k<e.sizeProjMini.r+this.margin&&(h.setOverlapping(!0),u=Math.max(u,e.sizeProjMini.r+this.margin-e.points[0].x)),l=function(){var a=k;return function(b){var c=b?e.points[0].x+b:b;e.points[1].setX(c||a),e.points[2].setX(c||a)}},v.push(l())),j=c-2>=0?c-2:c+2,0===j||3===j?(k=i.points[j].x-d,k>i.sizeProjMini.l-this.margin&&(h.setOverlapping(!0),u=Math.max(u,i.points[1].x-(i.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?i.points[1].x-b:b;i.points[0].setX(c||a),i.points[3].setX(c||a)}},v.push(l())):(k=i.points[j].x-d,k<i.sizeProjMini.r+this.margin&&(h.setOverlapping(!0),u=Math.max(u,i.sizeProjMini.r+this.margin-i.points[0].x)),l=function(){var a=k;return function(b){var c=b?i.points[0].x+b:b;i.points[1].setX(c||a),i.points[2].setX(c||a)}},v.push(l())),0!==u){for(m in v)v[m](u);return u}for(m in v)v[m]();return h.setOverlapping(!1),!1;case"bottom":if(d=b.x-i.points[c].x,j=c,0===j||3===j?(k=e.points[j].x+d,k>e.sizeProjMini.l-this.margin&&(h.setOverlapping(!0),u=Math.max(u,e.points[1].x-(e.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?e.points[1].x-b:b;e.points[0].setX(c||a),e.points[3].setX(c||a)}},v.push(l())):(k=e.points[j].x+d,k<e.sizeProjMini.r+this.margin&&(i.setOverlapping(!0),u=Math.max(u,e.sizeProjMini.r+this.margin-e.points[0].x)),l=function(){var a=k;return function(b){var c=b?e.points[0].x+b:b;e.points[1].setX(c||a),e.points[2].setX(c||a)}},v.push(l())),j=c-2>=0?c-2:c+2,0===j||3===j?(k=h.points[j].x-d,k>h.sizeProjMini.l-this.margin&&(i.setOverlapping(!0),u=Math.max(u,h.points[1].x-(h.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?h.points[1].x-b:b;h.points[0].setX(c||a),h.points[3].setX(c||a)}},v.push(l())):(k=h.points[j].x-d,k<h.sizeProjMini.r+this.margin&&(i.setOverlapping(!0),u=Math.max(u,h.sizeProjMini.r+this.margin-h.points[0].x)),l=function(){var a=k;return function(b){var c=b?h.points[0].x+b:b;h.points[1].setX(c||a),h.points[2].setX(c||a)}},v.push(l())),0!==u){for(m in v)v[m](u);return u}for(m in v)v[m]();return i.setOverlapping(!1),!1;case"up":if(d=b.x-e.points[c].x,j=c-2>=0?c-2:c+2,0===j||3===j?(k=h.points[j].x-d,k>h.sizeProjMini.l-this.margin&&(e.setOverlapping(!0),u=Math.max(u,h.points[1].x-(h.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?h.points[1].x-b:b;h.points[0].setX(c||a),h.points[3].setX(c||a)}},v.push(l())):(k=h.points[j].x-d,k<h.sizeProjMini.r+this.margin&&(e.setOverlapping(!0),u=Math.max(u,h.sizeProjMini.r+this.margin-h.points[0].x)),l=function(){var a=k;return function(b){var c=b?h.points[0].x+b:b;h.points[1].setX(c||a),h.points[2].setX(c||a)}},v.push(l())),j=c,0===j||3===j?(k=i.points[j].x+d,k>i.sizeProjMini.l-this.margin&&(e.setOverlapping(!0),u=Math.max(u,i.points[1].x-(i.sizeProjMini.l-this.margin))),l=function(){var a=k;return function(b){var c=b?i.points[1].x-b:b;i.points[0].setX(c||a),i.points[3].setX(c||a)}},v.push(l())):(k=i.points[j].x+d,k<i.sizeProjMini.r+this.margin&&(e.setOverlapping(!0),u=Math.max(u,i.sizeProjMini.r+this.margin-i.points[0].x)),l=function(){var a=k;return function(b){var c=b?i.points[0].x+b:b;i.points[1].setX(c||a),i.points[2].setX(c||a)}},v.push(l())),0!==u){for(m in v)v[m](u);return u}for(m in v)v[m]();return e.setOverlapping(!1),!1;case"left":if(o=f.points[1].x-f.points[0].x,p=o-(b.x-f.points[c].x),q=f.points[1].y-f.points[0].y,r=x(o,q),s=x(p,q),d=r-s,j=3>=c+1?c+1:0,3===j||2===j?(k=e.points[j].y+d,k<e.sizeProjMini.b+this.margin&&(f.setOverlapping(!0),u=Math.max(u,e.sizeProjMini.b+this.margin-e.points[0].y),t=w(u,q)/u),l=function(){var a=k;return function(b){var c=b?e.points[0].y+b:b;e.points[2].setY(c||a),e.points[3].setY(c||a)}},v.push(l())):(k=e.points[j].y+d,k>e.sizeProjMini.t-this.margin&&(f.setOverlapping(!0),u=Math.max(u,e.points[3].y-(e.sizeProjMini.t-this.margin)),t=w(u,q)/u),l=function(){var a=k;return function(b){var c=b?e.points[3].y-b:b;e.points[0].setY(c||a),e.points[1].setY(c||a)}},v.push(l())),d=b.x-f.points[c].x,j=c-2>=0?c-2:c+2,0===j||3===j?(k=g.points[j].x-d,k>g.sizeProjMini.l-this.margin&&(f.setOverlapping(!0),n=Math.max(u,x(g.points[1].x-(g.sizeProjMini.l-this.margin),q)),n>u&&(t=(g.points[1].x-(g.sizeProjMini.l-this.margin))/n,u=n)),l=function(){var a=k;return function(b){var c=b?g.points[1].x-b*t:b;g.points[0].setX(c||a),g.points[3].setX(c||a)}},v.push(l())):(k=g.points[j].x-d,k<g.sizeProjMini.r+this.margin&&(f.setOverlapping(!0),n=Math.max(u,x(g.sizeProjMini.r+this.margin-g.points[0].x,q)),n>u&&(t=(g.sizeProjMini.r+this.margin-g.points[0].x)/n,u=n)),l=function(){var a=k;return function(b){var c=b?g.points[0].x+b*t:b;g.points[1].setX(c||a),g.points[2].setX(c||a)}},v.push(l())),0!==u){for(m in v)v[m](u);return u*t}for(m in v)v[m]();return f.setOverlapping(!1),!1;case"right":if(o=g.points[1].x-g.points[0].x,p=o-(b.x-g.points[c].x),q=g.points[0].y-g.points[1].y,r=x(o,q),s=x(p,q),d=r-s,j=c-1>=0?c-1:3,3===j||2===j?(k=e.points[j].y-d,k<e.sizeProjMini.b+this.margin&&(g.setOverlapping(!0),u=Math.max(u,e.sizeProjMini.b+this.margin-e.points[0].y),t=w(u,q)/u),l=function(){var a=k;return function(b){var c=b?e.points[0].y+b:b;e.points[3].setY(c||a),e.points[2].setY(c||a)}},v.push(l())):(k=e.points[j].y-d,k>e.sizeProjMini.t-this.margin&&(g.setOverlapping(!0),u=Math.max(u,e.points[3].y-(e.sizeProjMini.t-this.margin)),t=w(u,q)/u),l=function(){var a=k;return function(b){var c=b?e.points[3].y-b:b;e.points[0].setY(c||a),e.points[1].setY(c||a)}},v.push(l())),d=b.x-g.points[c].x,j=c-2>=0?c-2:c+2,0===j||3===j?(k=f.points[j].x-d,k>f.sizeProjMini.l-this.margin&&(g.setOverlapping(!0),n=Math.max(u,x(f.points[1].x-(f.sizeProjMini.l-this.margin),q)),n>u&&(t=(f.points[1].x-(f.sizeProjMini.l-this.margin))/n,u=n)),l=function(){var a=k;return function(b){var c=b?f.points[1].x-b*t:b;f.points[0].setX(c||a),f.points[3].setX(c||a)}},v.push(l())):(k=f.points[j].x-d,k<f.sizeProjMini.r+this.margin&&(g.setOverlapping(!0),n=Math.max(u,x(f.sizeProjMini.r+this.margin-f.points[0].x,q)),n>u&&(t=(f.sizeProjMini.r+this.margin-f.points[0].x)/n,u=n)),l=function(){var a=k;return function(b){var c=b?f.points[0].x+b*t:b;f.points[1].setX(c||a),f.points[2].setX(c||a)}},v.push(l())),0!==u){for(m in v)v[m](u);return u*t}for(m in v)v[m]();return g.setOverlapping(!1),!1;default:return console.log("ERROR "+a+" is not a valid state")}}},{key:"checkBorderBoite",value:function(a,b){var c=b.findExtreme(),d=this.projections[a],e=d.findExtreme(),f={};if("left"===a||"right"===a){var g=d.points[2].y-d.points[1].y,h=d.points[3].y-d.points[0].y,i=b.getCenter();"left"===a?(e.t=e.b-g,c.t<e.t+d.margin&&(b.moveTo({x:i.x,y:e.b-(g-c.size.h/2-d.margin)}),c=b.findExtreme())):(e.t=e.b-h,c.t<e.t+d.margin&&(b.moveTo({x:i.x,y:e.b-(h-c.size.h/2-d.margin)}),c=b.findExtreme()))}else c.t<e.t+d.margin&&(f.y=c.t-d.margin,this.projectionsCollisionY(a,f,0),d.points[0].setY(c.t-d.margin),d.points[1].setY(c.t-d.margin));c.l<e.l+d.margin&&(f.x=c.l-d.margin,this.projectionsCollisionX(a,f,0),d.points[0].setX(c.l-d.margin),d.points[3].setX(c.l-d.margin)),c.r>e.r-d.margin&&(f.x=c.r+d.margin,this.projectionsCollisionX(a,f,1),d.points[1].setX(c.r+d.margin),d.points[2].setX(c.r+d.margin)),c.b>e.b-d.margin&&(f.y=c.b+d.margin,this.projectionsCollisionY(a,f,3),d.points[2].setY(c.b+d.margin),d.points[3].setY(c.b+d.margin))}},{key:"createProjectionsLimits",value:function(a){var b,c,d,e,f,g;b=this.projections.up.findAllExtreme(),c=this.projections.down.findAllExtreme(),d=this.projections.left.findAllExtreme(),e=this.projections.right.findAllExtreme(),f=this.projections.top.findAllExtreme(),g=this.projections.bottom.findAllExtreme(),this.projections.top.sizeProjMini=f,this.projections.bottom.sizeProjMini=g,this.projections.up.sizeProjMini=b,this.projections.down.sizeProjMini=c,this.projections.left.sizeProjMini=d,this.projections.right.sizeProjMini=e}},{key:"createProjectionsCoords",value:function(a){var b={top:{points:[{x:0,y:0},{x:this.getSide("w"),y:0},{x:this.getSide("w"),y:this.getSide("d2")},{x:0,y:this.getSide("d2")}]},bottom:{points:[{x:0,y:0},{x:this.getSide("w"),y:0},{x:this.getSide("w"),y:this.getSide("d1")},{x:0,y:this.getSide("d1")}]},up:{points:[{x:0,y:0},{x:this.getSide("w"),y:0},{x:this.getSide("w"),y:this.getSide("d")},{x:0,y:this.getSide("d")}]},down:{points:[{x:0,y:0},{x:this.getSide("w"),y:0},{x:this.getSide("w"),y:this.getSide("h")},{x:0,y:this.getSide("h")}]},left:{points:[{x:0,y:0},{x:this.getSide("h"),y:this.getSide("d2")-this.getSide("d1")},{x:this.getSide("h"),y:this.getSide("d2")},{x:0,y:this.getSide("d2")}]},right:{points:[{x:0,y:0},{x:this.getSide("h"),y:this.getSide("d1")-this.getSide("d2")},{x:this.getSide("h"),y:this.getSide("d1")},{x:0,y:this.getSide("d1")}]}};switch(a){case"top":return b.top;case"bottom":return b.bottom;case"up":return b.up;case"down":return b.down;case"left":return b.left;case"right":return b.right;case"all":return b;default:return console.log("ERROR "+a+" is not a valid state")}}},{key:"createProjection",value:function(){var a=this.createProjectionsCoords("all");this.projections.up=new f(this,a.up),this.projections.down=new f(this,a.down),this.projections.left=new f(this,a.left),this.projections.right=new f(this,a.right),this.projections.top=new f(this,a.top),this.projections.bottom=new f(this,a.bottom)}},{key:"updateProjection",value:function(a){var b,c=this.createProjectionsCoords(a).points,d=this.projections[a].points;b={x:d[0].x,y:d[0].y},0===b.x&&0===b.y&&(b.x=200,b.y=200);for(var e=0,f=d.length;f>e;e++)d[e].setX(c[e].x),d[e].setY(c[e].y),d[e].translate(b)}},{key:"updateAllProjections",value:function(a){this.updateMaster(a),this.updateProjection("top"),this.updateProjection("bottom"),this.updateProjection("left"),this.updateProjection("right"),this.updateProjection("up"),this.updateProjection("down")}},{key:"updateMaster",value:function(a){var b,c,d,e,f,g;switch(a){case"top":b=this.projections[a],this.setSide("w",b.points[1].x-b.points[0].x),this.setSide("d2",b.points[3].y-b.points[0].y);break;case"bottom":b=this.projections[a],this.setSide("w",b.points[1].x-b.points[0].x),this.setSide("d1",b.points[3].y-b.points[0].y);break;case"up":b=this.projections[a],d=b.points[3].y-b.points[0].y,e=this.getSide("d1"),f=this.getSide("d2"),g=f-e,c=Math.sqrt(d*d-g*g),this.setSide("w",b.points[1].x-b.points[0].x),this.setSide("d",d),this.setSide("h",c);break;case"down":b=this.projections[a],c=b.points[3].y-b.points[0].y,e=this.getSide("d1"),f=this.getSide("d2"),g=f-e,d=Math.sqrt(c*c+g*g),this.setSide("w",b.points[1].x-b.points[0].x),this.setSide("d",d),this.setSide("h",c);break;case"left":b=this.projections[a],c=b.points[2].x-b.points[3].x,f=b.points[3].y-b.points[0].y,e=b.points[2].y-b.points[1].y,g=f-e,this.setSide("h",c),this.setSide("d",Math.sqrt(c*c+g*g)),this.setSide("d1",e),this.setSide("d2",f);break;case"right":b=this.projections[a],c=b.points[2].x-b.points[3].x,e=b.points[3].y-b.points[0].y,f=b.points[2].y-b.points[1].y,g=f-e,this.setSide("h",c),this.setSide("d",Math.sqrt(c*c+g*g)),this.setSide("d1",e),this.setSide("d2",f);break;case"all":return!1;default:return console.log("ERROR "+a+" is not a valid state")}}}]),b}(),h=function(){function a(b){_classCallCheck(this,a);var c;if("string"==typeof b||c instanceof b){var d=b;b={},b.input=d}b.font=b.font||{},this._id=b._id||Math.floor(Math.random()*(1e6+1)),this.key=0,this.font={style:b.font.style||"normal",variant:b.font.variant||"normal",weight:b.font.weight||"normal",size:b.font.size||50,family:b.font.family||"sans-serif",textAlign:"center",baseline:"middle",sizeAbs:b.font.sizeAbs||50,color:b.font.color||"black",type:b.type||"fillText",isVertical:b.vertical||!1},this.input=b.input||"input",this.margin=b.margin||5,this.shapeObject=b.shape||"Rect",this.fonction=b.fonction||"texte",this.angle=b.angle||0,this.sizeTxt=b.sizeTxt||this.getSizeTxt(),this.size=b.size||{},this.points=b.points||this.createPoints(),this.posBox=this.points[0]}return _createClass(a,[{key:"fontSettings",value:function(){return this.font.style+" "+this.font.variant+" "+this.font.weight+" "+this.font.size+"px "+this.font.family}},{key:"getSizeTxt",value:function(){var a=document.createElement("canvas"),b=a.getContext("2d");return b.font=this.fontSettings(),this.isVertical?this.sizeTxt={w:b.measureText("A").width+2*this.margin,h:+this.font.size*this.input.length+2*this.margin
}:this.sizeTxt={w:b.measureText(this.input).width+2*this.margin,h:+this.font.size+2*this.margin},this.sizeTxt}},{key:"getBoxPos",value:function(){var a=this.getCenter(),b=this.findExtreme();return{x:a.x-b.size.w/2,y:a.y-b.size.h/2}}},{key:"createPoints",value:function(){return[new b({x:0,y:0}),new b({x:this.sizeTxt.w,y:0}),new b({x:this.sizeTxt.w,y:this.sizeTxt.h}),new b({x:0,y:this.sizeTxt.h})]}},{key:"actualisePoints",value:function(){var a,c,d,e,f,g,h,i;if(e=this.sizeTxt.w,f=this.sizeTxt.h,this.getSizeTxt(),c=this.sizeTxt.w,d=this.sizeTxt.h,g=(c-e)/2,h=(d-f)/2,g||h){a=[new b({x:-g,y:-h}),new b({x:g,y:-h}),new b({x:g,y:h}),new b({x:-g,y:h})],i=this.getCenter();for(var j=0,k=this.points.length;k>j;j++)this.points[j].rotate(-this.angle,i),this.points[j].translate(a[j]),this.points[j].rotate(this.angle,i)}}},{key:"getArea",value:function(){for(var a=0,b=0,c=this.points.length;c-1>b;b++)a+=this.points[b].x*this.points[b+1].y-this.points[b+1].x*this.points[b].y;return a+=this.points[c-1].x*this.points[0].y-this.points[0].x*this.points[c-1].y,a/=2}},{key:"getCenter",value:function(){for(var a,b=this.getArea(),c=0,d=0,e=0,f=this.points.length;f-1>e;e++)a=this.points[e].x*this.points[e+1].y-this.points[e+1].x*this.points[e].y,c+=(this.points[e].x+this.points[e+1].x)*a,d+=(this.points[e].y+this.points[e+1].y)*a;return a=this.points[f-1].x*this.points[0].y-this.points[0].x*this.points[f-1].y,c+=(this.points[f-1].x+this.points[0].x)*a,d+=(this.points[f-1].y+this.points[0].y)*a,c/=6*b,d/=6*b,{x:c,y:d}}},{key:"getCenterX",value:function(){return this.getCenter().x}},{key:"getCenterY",value:function(){return this.getCenter().y}},{key:"moveTo",value:function(a){var b=this.getCenter(),c={x:a.x-b.x,y:a.y-b.y};this.move(c)}},{key:"move",value:function(a){for(var b=0,c=this.points.length;c>b;b++)this.points[b].translate(a)}},{key:"findExtreme",value:function(){for(var a={t:1/0,r:-(1/0),b:-(1/0),l:1/0},b=function(a,b){a.t=Math.min(a.t,b.y),a.r=Math.max(a.r,b.x),a.b=Math.max(a.b,b.y),a.l=Math.min(a.l,b.x)},c=0,d=this.points.length;d>c;c++)b(a,this.points[c]);return a.size={w:a.r-a.l,h:a.b-a.t},this.size.w=a.size.w,this.size.h=a.size.h,a}},{key:"setSelected",value:function(a){this.isSelected=a}},{key:"setOverlapping",value:function(a){this.isOverlapping=a}},{key:"rotate",value:function(a,b){var c,d;for(b=b||{x:this.getCenterX(),y:this.getCenterY()},c=0,d=this.points.length;d>c;c++)this.points[c].rotate(a,b);this.changeShape(),this.angle+=a}},{key:"changeShape",value:function(){"Texte"===this.constructor.name&&(this.angle%90===0?this.shapeObject="Rect":this.shapeObject="Poly")}},{key:"drawHandler",value:function(a){var b,c,d=this.points.length;for(a.save(),a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y),b=0;d>b;b++)a.lineTo(this.points[b].x,this.points[b].y);for(a.closePath(),a.stroke(),a.fillStyle="white",c=0;d>c;c++)a.beginPath(),a.arc(this.points[c].x,this.points[c].y,5,0,2*Math.PI,!1),a.closePath(),a.stroke(),a.fill();a.restore()}},{key:"changeOrientation",value:function(){var a=this.getCenter();this.angle=0,this.getSizeTxt(),this.points=this.createPoints(),this.moveTo(a)}},{key:"drawCanvas",value:function(a){switch(a.save(),a.font=this.fontSettings(),a.fillStyle=this.font.color,a.textBaseline=this.font.baseline,a.textAlign=this.font.textAlign,this.type){case"fillText":default:var b,c,d;if(this.isVertical)for(a.translate(this.points[0].x,this.points[0].y),a.rotate(-this.angle*(2*Math.PI)/360),a.translate(this.sizeTxt.w/2,this.font.size/2),b=0,c=this.input.length;c>b;b++)a.fillText(this.input[b],0,b*this.font.size);else d=this.getCenter(),a.translate(d.x,d.y),a.rotate(-this.angle*(2*Math.PI)/360),a.fillText(this.input,0,0);break;case"strokeText":if(this.isVertical)for(a.translate(this.points[0].x,this.points[0].y),a.rotate(-this.angle*(2*Math.PI)/360),a.translate(this.sizeTxt.w/2,this.font.size/2),b=0,c=this.input.length;c>b;b++)a.strokeText(this.input[b],0,b*this.font.size);else d=this.getCenter(),a.translate(d.x,d.y),a.rotate(-this.angle*(2*Math.PI)/360),a.strokeText(this.input,0,0)}a.restore(),this.isSelected&&this.drawHandler(a)}}]),a}(),i=function(){function c(a,b){_classCallCheck(this,c),this.loc=b||"argument (location) missing",this.entity=a,this.margin=30,this.isSelected=!1,this.setMethods(this.loc),this.setPos(this.loc),this.setTriangleDraw(this.loc)}return _createClass(c,[{key:"setMethods",value:function(b){switch(b){case"right":this.setValue=function(b){var c=this.entity.findExtreme(),d=a.convertToPixel(b);this.entity.points[2].translate({x:0,y:d-c.size.h}),this.entity.points[3].translate({x:0,y:d-c.size.h})};break;case"bottom":this.setValue=function(b){var c=this.entity.findExtreme(),d=a.convertToPixel(b);this.entity.points[1].translate({x:d-c.size.w,y:0}),this.entity.points[2].translate({x:d-c.size.w,y:0})};break;default:console.log(b+"--> terme non reconnu par le constructeur Arrow")}}},{key:"setPos",value:function(c){switch(c){case"right":this.posStart=new b({x:this.entity.points[1].x+this.margin,y:this.entity.points[1].y}),this.posEnd=new b({x:this.entity.points[2].x+this.margin,y:this.entity.points[2].y}),this.posBox=new b({x:this.posStart.x+10,y:this.posStart.y+(this.posEnd.y-this.posStart.y)/2}),this.value=a.convertToMm(this.entity.points[2].y-this.entity.points[1].y);break;case"bottom":this.posStart=new b({x:this.entity.points[3].x,y:this.entity.points[3].y+this.margin}),this.posEnd=new b({x:this.entity.points[2].x,y:this.entity.points[2].y+this.margin}),this.posBox=new b({x:this.posStart.x+(this.posEnd.x-this.posStart.x)/2,y:this.posStart.y+20}),this.value=a.convertToMm(this.entity.points[2].x-this.entity.points[3].x);break;default:console.log(c+"--> terme non reconnu par le constructeur Arrow")}}},{key:"getBoxPos",value:function(){var b={};switch(this.loc){case"right":b={x:this.posStart.x+10,y:this.posStart.y+(this.posEnd.y-this.posStart.y)/2},this.value=a.convertToMm(this.entity.points[2].y-this.entity.points[1].y);break;case"bottom":b={x:this.posStart.x+(this.posEnd.x-this.posStart.x)/2,y:this.posStart.y+20},this.value=a.convertToMm(this.entity.points[2].x-this.entity.points[3].x);break;default:console.log(loc+"--> terme non reconnu par le constructeur Arrow")}return b}},{key:"setTriangleDraw",value:function(a){switch(a){case"right":this.drawTriangle=function(a){a.save(),a.fillStyle="gray",a.beginPath(),a.moveTo(this.posStart.x,this.posStart.y),a.lineTo(this.posStart.x-5,this.posStart.y+10),a.lineTo(this.posStart.x+5,this.posStart.y+10),a.closePath(),a.fill(),a.moveTo(this.posEnd.x,this.posEnd.y),a.lineTo(this.posEnd.x-5,this.posEnd.y-10),a.lineTo(this.posEnd.x+5,this.posEnd.y-10),a.closePath(),a.fill(),a.restore()},this.drawText=function(a){a.save(),a.font="14px sans-serif",a.fillText(this.value+" mm",this.posBox.x,this.posBox.y),a.restore()},this.drawCanvas=function(a){a.beginPath(),a.fillRect(this.posStart.x,this.posStart.y+5,1,this.posEnd.y-this.posStart.y-5),a.closePath(),this.drawTriangle(a)};break;case"bottom":this.drawTriangle=function(a){a.save(),a.fillStyle="gray",a.beginPath(),a.moveTo(this.posStart.x,this.posStart.y),a.lineTo(this.posStart.x+10,this.posStart.y-5),a.lineTo(this.posStart.x+10,this.posStart.y+5),a.closePath(),a.fill(),a.moveTo(this.posEnd.x,this.posEnd.y),a.lineTo(this.posEnd.x-10,this.posEnd.y-5),a.lineTo(this.posEnd.x-10,this.posEnd.y+5),a.closePath(),a.fill(),a.restore()},this.drawText=function(a){a.save(),a.font="14px sans-serif",a.fillText(this.value+" mm",this.posBox.x,this.posBox.y),a.restore()},this.drawCanvas=function(a){a.beginPath(),a.fillRect(this.posStart.x+5,this.posStart.y,this.posEnd.x-this.posStart.x-5,1),a.closePath(),this.drawTriangle(a)};break;default:console.log(a+"--> terme non reconnu par le constructeur Arrow")}}}]),c}(),j=function(b){function c(a,b){return _classCallCheck(this,c),_possibleConstructorReturn(this,Object.getPrototypeOf(c).call(this,a,b))}return _inherits(c,b),_createClass(c,[{key:"setMethods",value:function(b){switch(b){case"right":this.setValue=function(b){var c=a.convertToPixel(b);this.entity.points[1].translate({x:0,y:this.entity.points[2].y-this.entity.points[1].y-c})};break;case"bottom":this.setValue=function(b){var c=this.entity.findExtreme(),d=a.convertToPixel(b);this.entity.points[1].translate({x:d-c.size.w,y:0}),this.entity.points[2].translate({x:d-c.size.w,y:0})};break;default:console.log(b+"--> terme non reconnu par le constructeur ArrowPoint")}}}]),c}(i);return{newCercle:function(a){return new d(a)},newRect:function(a){return new e(a)},newBoite:function(){return new f},newArrow:function(a,b){return new i(a,b)},newArrowPoint:function(a,b){return new j(a,b)},newMasterBoite:function(a){return new g(a)},newTexte:function(a,b){return new h(a,b)}}}]),angular.module("pedaleswitchApp").factory("checkCollision",["intersect",function(a){return{checktest:function(b,c){var d,e,f=c.length;for(b.setOverlapping(!1),d=0;f>d;d++)e=c[d],b._id===e._id&&b.key===e.key||(e.setOverlapping(!1),a.polyInPoly(b,e)===!0&&(b.setOverlapping(!0),e.setOverlapping(!0)))},check:function(b,c){var d,e,f=c.length;for(b.setOverlapping(!1),d=0;f>d;d++)e=c[d],b._id===e._id&&b.key===e.key||(e.setOverlapping(!1),a.check(b,e)===!0&&(b.setOverlapping(!0),e.setOverlapping(!0)))},checkAll:function(b){var c,d,e,f=b.length,g=b.length;for(c=0;f>c;c++)for(e=b[c],b[c].setOverlapping(!1),d=0;g>d;d++)if(c!==d){var h=b[d];a.check(e,h)===!0&&(b[d].setOverlapping(!0),b[c].setOverlapping(!0))}},checkMouseBox:function(b,c,d){var e,f,g=c.length;for(e=0;g>e;e++)if(f=c[e],a.pointInRect(b,f.findExtreme(),d))return{id:e,dx:b.x-f.getCenterX(),dy:b.y-f.getCenterY()};return!1},checkPoly:function(b,c){var d,e,f=c.length;for(d=0;f>d;d++)if(e=c[d],a.pointInPoly(b,e.points))return{id:d,dx:b.x-e.getCenterX(),dy:b.y-e.getCenterY()};return!1},checkMouseBorder:function(b,c,d){var e,f,g,h=c.length;for(e=0;h>e;e++)if(g=c[e],f=a.pointOnRect(b,g.findExtreme(),d))return{id:e,dx:b.x-g.getCenterX(),dy:b.y-g.getCenterY(),pointer:f};return!1},checkMouseCorner:function(b,c,d,e){var f,g,h,i=c.length;for(f=0;i>f;f++)if(h=c[f],g=a.pointOnCorner(b,h,d,e))return{id:f,dx:b.x-h.getCenterX(),dy:b.y-h.getCenterY(),pointer:g};return!1},checkLine:function(b,c){var d,e,f=c.length,g={x:[],y:[]};for(d=0;f>d;d++)e=c[d],b._id===e._id&&b.key===e.key||(g.y=g.y.concat(a.pointInVertligne(b,e,10)),g.x=g.x.concat(a.pointInHoriligne(b,e,10)));return g}}}]),angular.module("pedaleswitchApp").factory("intersect",function(){return{check:function(a,b){switch(a.shapeObject){case"Rect":switch(b.shapeObject){case"Rect2":return this.rectInRect(a,b);case"Cercle2":return this.rectInCircle(a,b);case"Poly2":return this.polyInPoly(a,b);default:console.log(b.shapeObject+"---> Forme de l'element qui compare (comparitor) inconnue dans intersect")}break;case"Cercle":switch(b.shapeObject){case"Rect":return this.circleInRect(a,b);case"Cercle":return this.circleInCircle(a,b);case"Poly":return this.circleInPoly(a,b);default:console.log(b.shapeObject+"---> Forme de l'element qui compare (comparitor) inconnue dans intersect")}break;case"Poly":switch(b.shapeObject){case"Rect":return this.polyInPoly(a,b);case"Cercle":return this.polyInCircle(a,b);case"Poly":return this.polyInPoly(a,b);default:console.log(b.shapeObject+"---> Forme de l'element qui compare (comparitor) inconnue dans intersect")}break;default:console.log(a.shapeObject+"---> Forme de l'element qui compare (comparitor) inconnue dans intersect")}},between:function(a,b,c){var d;return d=this.betweenStrict(a,b,c),b!==a&&b!==c||(d=!0),d},betweenStrict:function(a,b,c){var d=!1;return c>a&&b>a&&c>b&&(d=!0),a>c&&b>c&&a>b&&(d=!0),d},pointInVertligne:function(a,b,c){c=c||0;var d,e,f,g=[],h=[],i=[],j=a.findExtreme();for(h.push(j.t),h.push(a.getCenterY()),h.push(j.b),j=b.findExtreme(),i.push(j.t),i.push(b.getCenterY()),i.push(j.b),e=0;3>e;e++)for(f=0;3>f;f++)this.betweenStrict(i[f]-c,h[e],i[f]+c)&&(d=g.push({y:i[f]}),h[e]===i[f]&&(g[d-1].isPile=!0));return g},pointInHoriligne:function(a,b,c){c=c||0;var d,e,f,g=[],h=[],i=[],j=a.findExtreme();for(h.push(j.l),h.push(a.getCenterX()),h.push(j.r),j=b.findExtreme(),i.push(j.l),i.push(b.getCenterX()),i.push(j.r),e=0;3>e;e++)for(f=0;3>f;f++)this.betweenStrict(i[f]-c,h[e],i[f]+c)&&(d=g.push({x:i[f]}),h[e]===i[f]&&(g[d-1].isPile=!0));return g},pointInRect:function(a,b,c){return c=c||0,this.between(b.l-c,a.x,b.r+c)&&this.between(b.t-c,a.y,b.b+c)},pointOnRect:function(a,b,c){if(c=c||0,this.between(b.l-c,a.x,b.r+c)){if(this.between(b.t-c,a.y,b.t+c))return{pos:"top",type:"ns-resize"};if(this.between(b.b-c,a.y,b.b+c))return{pos:"bottom",type:"ns-resize"}}if(this.between(b.b-c,a.y,b.t+c)){if(this.between(b.l-c,a.x,b.l+c))return{pos:"left",type:"ew-resize"};if(this.between(b.r-c,a.x,b.r+c))return{pos:"right",type:"ew-resize"}}return!1},pointOnCorner:function(a,b,c,d){c=c||10;var e,f,g,h,i;return e=d.indexOf("all"),f=d.indexOf("top-left"),g=d.indexOf("top-right"),h=d.indexOf("bottom-right"),i=d.indexOf("bottom-left"),-1===e&&-1===f||!this.pointInCircleLight(a,b.points[0],c)?-1===e&&-1===g||!this.pointInCircleLight(a,b.points[1],c)?-1===e&&-1===h||!this.pointInCircleLight(a,b.points[2],c)?-1===e&&-1===i||!this.pointInCircleLight(a,b.points[3],c)?!1:{pos:"bottom-left",type:"sw-resize"}:{pos:"bottom-right",type:"se-resize"}:{pos:"top-right",type:"ne-resize"}:{pos:"top-left",type:"nw-resize"}},isLeft:function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(c.x-a.x)*(b.y-a.y)},pointInPoly:function(a,b){var c=0,d=b.length;b.push(b[0]);for(var e=0;d>e;e++)b[e].y<=a.y?b[e+1].y>a.y&&this.isLeft(b[e],b[e+1],a)>0&&++c:b[e+1].y<=a.y&&this.isLeft(b[e],b[e+1],a)<0&&--c;return b.pop(),0!==c},pointInCircle:function(a,b){var c=a.getX()-b.getCenterX(),d=a.getY()-b.getCenterY();return Math.sqrt(c*c+d*d)<=b.getRadius()},pointInCircleLight:function(a,b,c){var d=a.x-b.x,e=a.y-b.y;return Math.sqrt(d*d+e*e)<=c},circleInCircle:function(a,b){var c=a.getCenterX()-b.getCenterX(),d=a.getCenterY()-b.getCenterY();return Math.sqrt(c*c+d*d)<=a.getRadius()+b.getRadius()},rectInRect:function(a,b){var c=a.findExtreme(),d=b.findExtreme();return c.l<d.l+d.size.w&&c.l+c.size.w>d.l&&c.t<d.t+d.size.h&&c.size.h+c.t>d.t},rectInCircle:function(a,b){var c=a.findExtreme(),d=Math.abs(b.getCenterX()-c.l-c.size.w/2),e=Math.abs(b.getCenterY()-c.t-c.size.h/2);if(d>c.size.w/2+b.getRadius())return!1;if(e>c.size.h/2+b.getRadius())return!1;if(d<=c.size.w/2)return!0;if(e<=c.size.h/2)return!0;var f=d-c.size.w/2,g=e-c.size.h/2;return f*f+g*g<=b.getRadius()*b.getRadius()},circleInRect:function(a,b){return this.rectInCircle(b,a)},circleInLine:function(a,b,c,d){var e,f,g,h={},i={};return h.x=b.x-a.x,h.y=b.y-a.y,i.x=c.x-a.x,i.y=c.y-a.y,e=Math.abs(h.x*i.y-h.y*i.x),f=Math.sqrt(h.x*h.x+h.y*h.y),g=e/f,d>g},circleInSegment:function(a,b,c,d){if(!this.circleInLine(a,b,c,d))return!1;var e,f,g={},h={},i={};return g.x=b.x-a.x,g.y=b.y-a.y,h.x=c.x-a.x,h.y=c.y-a.y,i.x=c.x-b.x,i.y=c.y-b.y,e=g.x*h.x+g.y*h.y,f=-g.x*i.x+-g.y*i.y,e>=0&&f>=0?!0:this.pointInCircleLight(a,c,d)?!0:!!this.pointInCircleLight(b,c,d)},circleInPoly:function(a,b){var c,d,e,f,g;for(e=b.points,d=e.length,f=a.getCenter(),g=a.getRadius(),c=0;d-1>c;c++)if(this.circleInSegment(e[c],e[c+1],f,g))return!0;return this.circleInSegment(e[0],e[d-1],f,g)?!0:this.pointInPoly(f,e)},polyInCircle:function(a,b){var c,d,e,f,g;for(e=a.points,d=e.length,f=b.getCenter(),g=b.getRadius(),c=0;d-1>c;c++)if(this.circleInSegment(e[c],e[c+1],f,g))return!0;return this.circleInSegment(e[0],e[d-1],f,g)?!0:this.pointInPoly(f,e)},segmentIntersection:function(a,b,c,d){var e,f,g,h={},i={};return h.x=b.x-a.x,h.y=b.y-a.y,i.x=d.x-c.x,i.y=d.y-c.y,e=h.x*i.y-h.y*i.x,0===e?!1:(f=-(a.x*i.y-c.x*i.y-i.x*a.y+i.x*c.y)/e,0>f||f>=1?!1:(g=-(-h.x*a.y+h.x*c.y+h.y*a.x-h.y*c.x)/e,!(0>g||g>=1)))},polyInPoly:function(a,b){var c,d,e,f,g,h;for(f=a.points,e=f.length,g=b.points,h=g.length,c=0;e-1>c;c++){for(d=0;h-1>d;d++)if(this.segmentIntersection(f[c],f[c+1],g[d],g[d+1]))return!0;if(this.segmentIntersection(f[c],f[c+1],g[0],g[h-1]))return!0}for(d=0;h-1>d;d++)if(this.segmentIntersection(f[0],f[e-1],g[d],g[d+1]))return!0;return this.segmentIntersection(f[0],f[e-1],g[0],g[h-1])?!0:this.pointInPoly(f[0],g)}}});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d,e,f){_classCallCheck(this,a),this.$http=b,this.socket=d,this.composants={},this.composantTypes=[],this.newComposant={titre:"",type:"",shape:"",description:"",disponible:!0,prix_additionnel:"",size:{w:"",h:""},media:[]},this.isLoggedIn=e.isLoggedIn,this.isAdmin=e.isAdmin,this.getCurrentUser=e.getCurrentUser,this.nbItems=0,this.currentPage=1,this.itemsPerPage=10,this.loading=!0,this.OrderArray=f,c.$on("$destroy",function(){d.unsyncUpdates("composant")})}return a.$inject=["$http","$scope","socket","Auth","OrderArray"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.loading=!0,this.$http.get("/api/composants").then(function(b){a.composants=a.OrderArray.order(b.data,"type"),a.nbItems=a.composants.length,a.socket.syncUpdates("composant",a.composants),a.loading=!1})}},{key:"addComposant",value:function(){this.newComposant&&this.$http.post("/api/composants",{titre:this.newComposant.titre,type:this.newComposant.type,shape:this.newComposant.shape,description:this.newComposant.description,disponible:this.newComposant.disponible,prix_additionnel:this.newComposant.prix_additionnel,size:{w:this.newComposant.size.w,h:this.newComposant.size.h},media:[]}),this.newComposant={titre:"",type:"",shape:"",description:"",disponible:!0,prix_additionnel:"",size:{w:"",h:""},media:[]}}},{key:"deleteComposant",value:function(a){this.$http["delete"]("/api/composants/"+a._id)}}]),a}();angular.module("pedaleswitchApp").component("composant",{templateUrl:"app/composant/composant.html",controller:a})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("composant",{url:"/composant",template:"<composant></composant>"})}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d){_classCallCheck(this,a),this.$http=b,this.socket=d,c.$on("$destroy",function(){d.unsyncUpdates("composantType")})}return a.$inject=["$http","$scope","socket"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/composantTypes").then(function(b){a.composantTypes=b.data,a.socket.syncUpdates("composantType",a.composantTypes)})}},{key:"addComposantType",value:function(){this.newComposantType.titre&&this.$http.post("/api/composantTypes",{titre:this.newComposantType.titre}),this.newComposantType=""}},{key:"deleteComposantType",value:function(a){this.$http["delete"]("/api/composantTypes/"+a._id)}},{key:"updateComposantType",value:function(a){this.$http.put("/api/composantTypes/"+a._id,a)}}]),a}();angular.module("pedaleswitchApp").component("composantType",{templateUrl:"app/composantType/composantType.html",controller:a,require:{ctrlCompo:"^composant"},bindings:{composantTypes:"="}})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("composantType",{url:"/composantType",template:"<composant-type></composant-type>"})}]),angular.module("pedaleswitchApp").directive("draggable",function(){return{link:function(a,b){var c=b[0],d=a;c.draggable=!0,c.addEventListener("dragstart",function(a){this.classList.add("drag");var b=document.createElement("canvas"),c={w:d.effet.points[1].x-d.effet.points[0].x,h:d.effet.points[2].y-d.effet.points[1].y};b.width=c.w,b.height=c.h;var e=b.getContext("2d"),f=document.createElement("img");e.beginPath(),e.lineWidth=5,e.strokeStyle="red",e.moveTo(d.effet.points[0].x,d.effet.points[0].y);for(var g=0,h=d.effet.points.length;h>g;g++)e.lineTo(d.effet.points[g].x,d.effet.points[g].y);return e.closePath(),e.stroke(),f.src=b.toDataURL("image/gif"),a.dataTransfer.setDragImage(f,b.width/2,b.height/2),a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("data",JSON.stringify(d.effet)),!1},!1),c.addEventListener("dragend",function(a){return this.classList.remove("drag"),!1},!1)}}}),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"app/account/login/login.html",controller:"LoginController",controllerAs:"vm"}).state("logout",{url:"/logout?referrer",referrer:"main",template:"",controller:["$state","Auth",function(a,b){var c=a.params.referrer||a.current.referrer||"main";b.logout(),a.go(c)}]}).state("signup",{url:"/signup",templateUrl:"app/account/signup/signup.html",controller:"SignupController",controllerAs:"vm"}).state("settings",{url:"/settings",templateUrl:"app/account/settings/settings.html",controller:"SettingsController",controllerAs:"vm",authenticate:!0})}]).run(["$rootScope",function(a){a.$on("$stateChangeStart",function(a,b,c,d){"logout"===b.name&&d&&d.name&&!d.authenticate&&(b.referrer=d.name)})}]),angular.module("pedaleswitchApp").constant("jdFontselectConfig",{googleApiKey:"AIzaSyB8Mc4o5SV8DMxXM9otLzOMZmgxQnbcBvA"}),angular.module("pedaleswitchApp").factory("instanceDessin",["$http","canvasConversion",function(a,b){function c(a,b){return[{x:b.x-a.w/2,y:b.y-a.h/2},{x:b.x+a.w/2,y:b.y-a.h/2},{x:b.x+a.w/2,y:b.y+a.h/2},{x:b.x-a.w/2,y:b.y+a.h/2}]}var d=[],e={},f={options:[],boite:{}};return a.get("/api/composants").then(function(a){d=a.data;for(var b=0;b<d.length;b++)e[d[b]._id]=d[b]}),{reset:function(){f.options=[],f.boite={}},getDessin:function(){return f},setDessin:function(a){return f=a},setBoite:function(a){f.boite=a},getComposantItems:function(){return e},searchEffetInDessin:function(a,b){for(var c=0;c<f.options.length;c++)if(f.options[c]._id===a&&f.options[c].key===b)return f.options[c];return!1},setEffet:function(a,d){var g=f.options.length,h=0,i={_id:d._id,key:g,itemInfo:{shape:null},inCanvas:a.inCanvas||!1,fonction:"effet",titre:a.titre,titreOption:d.titre,description:a.description,descriptionOption:d.description,prix:d.prix,points:{},composants:[]};i.points=c(d.size,{x:h+d.size.w/2,y:h+d.size.h/2});for(var j=0;j<d.composants.length;j++){var k={_id:d.composants[j]._id,key:g,fonction:"composant",titre:d.composants[j].titre,titreParentEffet:a.titre,titreParentOption:d.titre,pointsDefault:c(e[d.composants[j].available_compo_id[0]].size,d.composants[j].pos),points:c(e[d.composants[j].available_compo_id[0]].size,d.composants[j].pos),itemInfo:{idItem:e[d.composants[j].available_compo_id[0]]._id,items:d.composants[j].available_compo_id,shape:e[d.composants[j].available_compo_id[0]].shape,titreItem:e[d.composants[j].available_compo_id[0]].titre,prixAdd:e[d.composants[j].available_compo_id[0]].prix_additionnel}};i.composants.push(k)}b.convertEffetSize(i),b.initializeEffetZoom(i),f.options.push(i)},zoomInitialize:function(a){b.setZoom(a);for(var c=0;c<f.options.length;c++)b.initializeEffetZoom(f.options[c])},zoomChange:function(a){var c=b.setZoom(a);if(c){"MasterBoite"===f.boite.fonction&&b.convertEffetZoom(f.boite);for(var d=0;d<f.options.length;d++)b.convertEffetZoom(f.options[d])}return c},updateComposant:function(a,b){var c={titreItem:e[b].titre,idItem:e[b]._id,size:e[b].size,prixAdd:e[b].prix_additionnel,shape:e[b].shape};a=_.merge(a.itemInfo,c)}}}]),angular.module("pedaleswitchApp").directive("loading3",function(){return{template:'<div><div ng-show="loading2" class="loading-container"></div><div ng-hide="loading2" ng-transclude></div></div>',restrict:"A",transclude:!0,replace:!0,scope:{loading2:"=loading3"},compile:function(a,b,c){var d=a.find(".loading-container")[0],e=document.createElement("img");e.setAttribute("src","assets/images/spin.b544abb7.gif"),e.setAttribute("height","768"),e.setAttribute("width","1024"),e.setAttribute("alt","spin"),d.appendChild(e)}}});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d){_classCallCheck(this,a),this.$http=b,this.socket=d,this.awesomeThings=[],c.$on("$destroy",function(){d.unsyncUpdates("thing")})}return a.$inject=["$http","$scope","socket"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/things").then(function(b){a.awesomeThings=b.data,a.socket.syncUpdates("thing",a.awesomeThings)})}},{key:"addThing",value:function(){this.newThing&&(this.$http.post("/api/things",{name:this.newThing}),this.newThing="")}},{key:"deleteThing",value:function(a){this.$http["delete"]("/api/things/"+a._id)}}]),a}();angular.module("pedaleswitchApp").component("main",{templateUrl:"app/main/main.html",controller:a})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("main",{url:"/",template:"<main></main>"})}]),angular.module("pedaleswitchApp").factory("mouseHelper",["canvasControl","canvasConversion","checkCollision","canvasDraw","$rootScope",function(a,b,c,d,e){var f,g,h={},i=[],j=[],k=100,l=500,m=null,n={},o=a.getCanvasSetting(),p=function(a){document.body.style.cursor=a},q=function r(a){var r={x:a.layerX+2,y:a.layerY+21},b=o.ctx.getImageData(r.x,r.y,1,1).data,c="rgba("+b[0]+","+b[1]+","+b[2]+","+b[3]+")",d="#"+tinycolor(c).toHex();return r.color=d,r};return{eyedropper:function(){var b=a.getTableText(),c=a.getActiveItem();h={},h.id=a.searchTabByIdReturnIndex(b,c[0]._id,0),a.resetActiveItem(),p("url('assets/images/eyedropper-24x24.4c07ea28.png'), auto"),e.$emit("color")},mouseMoveColor:function(b){n=q(b);var c=a.getTableText();c[h.id].font.color=n.color,d.drawStuff()},mouseDownColor:function(b){n=q(b);var c=a.getTableText();c[h.id].font.color=n.color,d.drawStuff(),e.$emit("no-click-on-element")},mouseMove:function(b){if(n={x:b.layerX,y:b.layerY},i=a.getTableActive(),j=a.getBoite(),p("default"),i.length>0){if(h=c.checkMouseBox(n,i,10))return i[h.id].input?h.type="deco":h.type="thing",void(m!==h.id&&"deco"!==h.type&&(i[h.id].setSelected(!0),null!==m&&i[m].setSelected(!1),m=h.id,d.drawStuff()));null!==m&&(i[m].setSelected(!1),d.drawStuff()),m=null}if(void 0!==j.titre){switch(o.viewState){case"up":if(h=c.checkMouseBorder(n,[j],10))return h.type="borderboite",void p(h.pointer.type);break;case"left":if(h=c.checkMouseCorner(n,[j],10,["top-left"]))return h.type="cornersideboite",void p(h.pointer.type);if(h=c.checkMouseBorder(n,[j],10),h&&"top"!==h.pointer.pos)return h.type="borderboite",void p(h.pointer.type);break;case"right":if(h=c.checkMouseCorner(n,[j],10,["top-right"]))return h.type="cornersideboite",void p(h.pointer.type);if(h=c.checkMouseBorder(n,[j],10),h&&"top"!==h.pointer.pos)return h.type="borderboite",void p(h.pointer.type);break;case"top":break;case"bottom":break;case"down":break;default:return console.log("ERROR "+o.viewState+" is not a valid state")}h=c.checkMouseBox(n,[j],10),h&&(h.type="boite")}},mouseDown:function(b){switch(n={x:b.layerX,y:b.layerY},a.resetActiveItem(),f=(new Date).getTime(),g=0,h.type){case"thing":e.$emit("click-on-thing");break;case"boite":e.$emit("click-on-boite");break;case"cornersideboite":e.$emit("click-on-corner-side-boite");break;case"borderboite":e.$emit("click-on-border-boite");break;case"deco":e.$emit("click-on-deco");break;default:e.$emit("no-click-on-element"),h={}}},mouseMoveDeco:function(a){if(i[h.id].isSelected===!0){if(g=(new Date).getTime()-f,k>g)return;i[h.id].move({x:a.layerX-n.x,y:a.layerY-n.y}),n={x:a.layerX,y:a.layerY},p("move"),d.drawStuff()}},mouseMouveCornerSideBoite:function(b){if(g=(new Date).getTime()-f,!(k>g)){n={x:b.layerX,y:b.layerY};var c=!1,e=a.getMasterBoite(),i=j.findAllExtreme(),l=a.getBoite().margin;switch(o.viewState){case"left":"nw-resize"===h.pointer.type&&(n.y<o.marginCanvas&&(n.y=o.marginCanvas),n.y>j.points[1].y&&(n.y=j.points[1].y),n.y>i.t-l&&(n.y=i.t-l),c=e.projectionsCollisionY(o.viewState,n,0),c&&(n.y=j.points[3].y-c),j.points[0].setY(n.y));break;case"right":"ne-resize"===h.pointer.type&&(n.y<o.marginCanvas&&(n.y=o.marginCanvas),n.y>j.points[0].y&&(n.y=j.points[0].y),n.y>i.t-l&&(n.y=i.t-l),c=e.projectionsCollisionY(o.viewState,n,1),c&&(n.y=j.points[2].y-c),j.points[1].setY(n.y));break;default:return console.log("ERROR "+o.viewState+' is not a valid state. Only "left" or "right" allowed')}a.setArrowPos(),d.drawStuff()}},mouseMoveBorderBoite:function(b){var c,e,i=50;if(g=(new Date).getTime()-f,!(k>g)){n={x:b.layerX,y:b.layerY};var l=!1,m=j.findAllExtreme(),p=a.getMasterBoite(),q=a.getBoite().margin;i="left"===o.viewState||"right"===o.viewState?p.initialHeight:i,"ns-resize"===h.pointer.type?"bottom"===h.pointer.pos?(n.y>.8*o.canvas.height&&(o.canvas.height=1.2*n.y),n.y<m.b+q&&(n.y=m.b+q),c=j.points[3].y-j.points[0].y,e=j.points[2].y-j.points[1].y,e>=c?n.y<j.points[0].y+i&&(n.y=j.points[0].y+i):n.y<j.points[1].y+i&&(n.y=j.points[1].y+i),l=p.projectionsCollisionY(o.viewState,n,3),l&&("right"===o.viewState?n.y=j.points[1].y+l:n.y=j.points[0].y+l),j.points[2].setY(n.y),j.points[3].setY(n.y)):(n.y<o.marginCanvas&&(n.y=o.marginCanvas),n.y>m.t-q&&(n.y=m.t-q),l=p.projectionsCollisionY(o.viewState,n,0),l&&(n.y=j.points[3].y-l),j.points[0].setY(n.y),j.points[1].setY(n.y)):"right"===h.pointer.pos?(n.x<m.r+q&&(n.x=m.r+q),l=p.projectionsCollisionX(o.viewState,n,1),l&&(n.x=j.points[0].x+l),j.points[1].setX(n.x),j.points[2].setX(n.x),n.x>.8*o.canvas.width&&(o.canvas.width=1.2*n.x)):(n.x<o.marginCanvas&&(n.x=o.marginCanvas),n.x>m.l-q&&(n.x=m.l-q),l=p.projectionsCollisionX(o.viewState,n,0),l&&(n.x=j.points[1].x-l),j.points[0].setX(n.x),j.points[3].setX(n.x)),a.setArrowPos(),d.drawStuff()}},mouseMoveBoite:function(b){if(g=(new Date).getTime()-f,!(k>g)){p("move");var c={x:j.points[0].x,y:j.points[0].y};j.move({x:b.layerX-n.x,y:b.layerY-n.y}),j.moveCloseBorder(o.canvas,o.marginCanvas),c={x:j.points[0].x-c.x,y:j.points[0].y-c.y},j.moveEffetCompo(c),a.setArrowPos(),d.drawStuff(),n={x:b.layerX,y:b.layerY}}},mouseMoveThing:function(b){var e=a.getMasterBoite();g=(new Date).getTime()-f,k>g||(i[h.id].move({x:b.layerX-n.x,y:b.layerY-n.y}),n={x:b.layerX,y:b.layerY},p("move"),i[h.id].moveCloseBorder(o.canvas,o.marginCanvas,j.margin),o.debrayable||i[h.id].resetCompPos(),c.check(i[h.id],i),a.setTableAlignLine(c.checkLine(i[h.id],i)),e.checkBorderBoite(o.viewState,i[h.id]),a.setArrowPos(),d.drawStuff())},mouseUpDefault:function(b){g=(new Date).getTime()-f,l>g&&(a.resetIsSelected(i),d.drawStuff())},mouseUp:function(b){g=(new Date).getTime()-f,l>g&&a.resetIsSelected(i),l>g&&"boite"!==h.type&&i[h.id]&&(a.setActiveItem(i[h.id]),"deco"===h.type&&i[h.id].setSelected(!0)),n={},p("default"),e.$emit("no-click-on-element"),c.checkAll(i),a.setTableAlignLine([]),d.drawStuff()}}}]),function(){angular.module("pedaleswitchApp").directive("boxArrow",["$timeout",function(a){return{restrict:"EA",templateUrl:"app/pageDessin/box-dessin/box-arrow/box-arrow.html",bindToController:{datas:"=",actions:"="},controller:["$scope",function(b){this.onBlur=function(){a.cancel(this.mypromise),this.storeValue=this.value,this.value=null;var b=this;this.mypromise=a(function(){b.change=!1},200,b)},this.$onInit=function(){this.zIndex="2"},this.onFocus=function(){this.mypromise&&a.cancel(this.mypromise),this.value=this.storeValue=this.datas.value,this.change=!0},this.validation=function(){this.storeValue&&this.datas.setValue(this.storeValue),this.change=!1,this.value=this.storeValue=null,this.actions.arrowChangeValue()}}],controllerAs:"$ctrl"}}])}(),function(){angular.module("pedaleswitchApp").directive("boxDessin",function(){return{restrict:"EA",transclude:!0,templateUrl:"app/pageDessin/box-dessin/box-dessin.html",bindToController:{data:"=",actions:"=",items:"<"},controller:["$scope",function(a){this.$onInit=function(){if("Arrow"!==this.data.constructor.name&&"ArrowPoint"!==this.data.constructor.name)switch(this.zIndex="-2",this.data.fonction){
case"effet":this.popUpUrl="app/pageDessin/box-dessin/option-box-popover-effet.html";break;case"composant":this.popUpUrl="app/pageDessin/box-dessin/option-box-popover-composant.html";break;case"texte":this.popUpUrl="app/pageDessin/box-dessin/option-box-popover-texte.html";break;case"image":this.popUpUrl="app/pageDessin/box-dessin/option-box-popover-image.html";break;case"forme":this.popUpUrl="app/pageDessin/box-dessin/option-box-popover-forme.html"}else this.zIndex="2"}}],controllerAs:"$ctrl"}})}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("decoDessin",{templateUrl:"app/pageDessin/deco-dessin/deco-dessin.html",bindings:{addTextToTable:"&",items:"<"},controller:a})}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("menuDessin",{templateUrl:"app/pageDessin/menu-dessin/menu-dessin.html",bindings:{deco:"=",switchDeco:"&",debrayable:"=",switchDeb:"&",isActive:"<",activeEffet:"&",activeCompo:"&"},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b){_classCallCheck(this,a),this.modalServ=b}return a.$inject=["$uibModal"],_createClass(a,[{key:"open",value:function(a){var b=this;b.modalInstance=b.modalServ.open({animation:!0,templateUrl:function(){return"app/pageDessin/modal-dessin/"+b.template+".html"||"app/pageDessin/modal-dessin/modalBox.html"},controller:"ModalDessinBox",controllerAs:"modal",resolve:{data:function(){return b.data},items:function(){return b.items},selected:function(){return b.selected}},size:a}),this.modalInstance.result.then(function(a){b.actions.updateComposant(b.data,a)})}}]),a}();angular.module("pedaleswitchApp").component("modalDessin",{templateUrl:"app/pageDessin/modal-dessin/modal-dessin.html",bindings:{data:"<",items:"<",selected:"<",template:"@",name:"@",classBtn:"@",actions:"="},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d,e){_classCallCheck(this,a),this.$uibModalInstance=b,this.data=c,this.items=d,this.selected=e}return a.$inject=["$uibModalInstance","data","items","selected"],_createClass(a,[{key:"ok",value:function(){this.$uibModalInstance.close(this.selected)}},{key:"cancel",value:function(){this.$uibModalInstance.dismiss("cancel")}}]),a}();angular.module("pedaleswitchApp").controller("ModalDessinBox",a)}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("modifDessin",{templateUrl:"app/pageDessin/modif-dessin/modif-dessin.html",bindings:{data:"=",actions:"="},controller:a})}(),function(){var a=function b(){_classCallCheck(this,b)};angular.module("pedaleswitchApp").component("navigationDessin",{templateUrl:"app/pageDessin/navigation-dessin/navigation-dessin.html",bindings:{zoom:"<",zoomAdd:"&",load:"&",save:"&",up:"&",down:"&",right:"&",left:"&",top:"&",bottom:"&"},controller:a})}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d,e,f,g,h,i){_classCallCheck(this,a),this.funcMenuPopOver={self:this,rotate:function(a,b){this.self.rotate(a,b)},eyeDropper:function(){this.self.eyedropper()},updateComposant:function(a,b){this.self.updateComposant(a,b)},dataChange:function(a){this.self.dataChange(a)},arrowChangeValue:function(){this.self.arrowChangeValue()},changeFont:function(a,b){var c=this.self;b.font.family=a.stack,c.$timeout(function(){c.dataChange(b)},300)}},this.$timeout=i,this.instanceDessin=b,this.canvasControl=d,this.canvasConversion=c,this.canvasDraw=e,this.storage=f,this.mouseHelper=h,this.$http=g}return a.$inject=["instanceDessin","canvasConversion","canvasControl","canvasDraw","storage","$http","mouseHelper","$timeout"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/effets").then(function(b){a.effets=b.data,0===a.instanceDessin.getDessin().options.length&&a.instanceDessin.setEffet(a.effets[0],a.effets[0].options[0])}),this.initialisation()}},{key:"initialisation",value:function(){this.items=this.instanceDessin.getComposantItems(),this.dessin=this.instanceDessin.getDessin(),this.tableArrow=this.canvasControl.getTableArrow(),this.tableText=this.canvasControl.getTableText(),this.activeItem=this.canvasControl.getActiveItem(),this.canvasSetting=this.canvasControl.getCanvasSetting(),this.zoom=this.canvasControl.getZoom(),this.debrayable=this.canvasSetting.debrayable,this.deco=!1,this.activeEffet(),this.toutesTables=this.canvasControl.tableState()}},{key:"load",value:function(){this.canvasControl.resetAll();var a=this.storage.get("dessin");this.dessin=this.instanceDessin.setDessin(a),this.canvasConversion.convertDessinToPixel(this.dessin),this.canvasControl.restoreCanvas(this.dessin),this.debrayable=this.dessin.debrayable,this.switchDeb(this.debrayable),this.tableArrow=this.canvasControl.getTableArrow(),this.activeEffet()}},{key:"save",value:function(){this.canvasConversion.convertDessinToMm(this.dessin);var a=JSON.parse(JSON.stringify(this.dessin));this.canvasConversion.convertDessinToPixel(this.dessin),a.debrayable=this.canvasSetting.debrayable,this.storage.put("dessin",a)}},{key:"mouseOnEffet",value:function(a){var b=[],c=this.canvasControl.searchEffetById(a._id,a.key);if(c){switch(this.isActive){case"effet":b.push(c),this.canvasControl.setTableDrawShine(b);break;case"composant":this.canvasControl.setTableDrawShine(c.composants);break;case"boite":this.canvasControl.setTableDrawShine([this.canvasControl.getBoite()]);break;case"deco":break;default:return console.log('Variable "isActive" not defined in pageDessin.controller.js : '+this.isActive)}this.canvasDraw.drawStuff()}}},{key:"switchDeb",value:function(){this.canvasControl.setDeb(this.debrayable),this.canvasControl.resetCompPos(this.debrayable),this.debrayable||this.activeEffet()}},{key:"switchDeco",value:function(){this.deco?(this.isActive="deco",this.canvasControl.canvasDrawState("deco"),this.canvasDraw.drawStuff()):this.debrayable?(this.isActive="composant",this.canvasControl.canvasDrawState(this.isActive),this.canvasDraw.drawStuff()):(this.isActive="effet",this.canvasControl.canvasDrawState(this.isActive),this.canvasDraw.drawStuff())}},{key:"activeEffet",value:function(){this.isActive="effet";var a=this.canvasControl.canvasDrawState("effet");a&&this.canvasDraw.drawStuff()}},{key:"activeCompo",value:function(){this.isActive="composant";var a=this.canvasControl.canvasDrawState("composant");a&&this.canvasDraw.drawStuff()}},{key:"addToTable",value:function(a){a.inCanvas||this.canvasControl.addToCanvas(a),this.instanceDessin.setBoite(this.canvasControl.getMasterBoite()),this.canvasDraw.drawStuff()}},{key:"addTextToTable",value:function(a){this.canvasControl.addTextToCanvas(a),this.canvasDraw.drawStuff()}},{key:"dataChange",value:function(a){var b;b=4,void 0==a.input&&(a.input=" "),(void 0==a.font.size||a.font.size<=0)&&(a.font.size=1),this.canvasControl.actualisePoints(a),this.canvasDraw.drawStuff()}},{key:"removeToTable",value:function(a){this.canvasControl.removeToCanvas(a),this.canvasDraw.drawStuff()}},{key:"zoomAdd",value:function(a){this.instanceDessin.zoomChange(a),this.canvasControl.centerInCanvas(),this.canvasControl.resizeCanvas(),this.canvasControl.setArrowPos(),this.zoom=this.canvasControl.getZoom(),this.canvasDraw.drawStuff()}},{key:"up",value:function(){this.canvasControl.canvasViewState("up"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"down",value:function(){this.canvasControl.canvasViewState("down"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"right",value:function(){this.canvasControl.canvasViewState("right"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"left",value:function(){this.canvasControl.canvasViewState("left"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"top",value:function(){this.canvasControl.canvasViewState("top"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"bottom",value:function(){this.canvasControl.canvasViewState("bottom"),this.canvasControl.canvasDrawState(this.isActive),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"rotate",value:function(a,b){b.rotate(a,null,this.debrayable),this.canvasControl.checkBorderBoxRotate(b),this.canvasControl.setArrowPos(),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"eyedropper",value:function(){this.mouseHelper.eyedropper(),this.canvasDraw.drawStuff()}},{key:"arrowChangeValue",value:function(){this.canvasControl.setArrowPos(),this.canvasControl.resizeCanvas(),this.canvasDraw.drawStuff()}},{key:"updateComposant",value:function(a,b){this.instanceDessin.updateComposant(a,b),this.canvasControl.updateComposantInCanvas(a),this.canvasDraw.drawStuff()}},{key:"mouseOnCompo",value:function(a){var b=[],c=this.canvasControl.searchCompoById(a._id,a.key);c&&(b.push(c),this.canvasControl.resetTableDrawShine(),this.canvasControl.setTableDrawShine(b),this.tableDrawShine=this.canvasControl.getTableDrawShine(),this.canvasDraw.drawStuff())}},{key:"mouseLeaveEffet",value:function(){this.canvasControl.resetTableDrawShine(),this.canvasDraw.drawStuff()}},{key:"getTable",value:function(){this.toutesTables=[this.canvasControl.tableState(),this.instanceDessin.getDessin()]}}]),a}();angular.module("pedaleswitchApp").component("pageDessin",{templateUrl:"app/pageDessin/pageDessin.html",controller:a})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("pageDessin",{url:"/pageDessin",template:"<page-dessin></page-dessin>"})}]),function(){var a=function b(){_classCallCheck(this,b),this.newItem=""};angular.module("pedaleswitchApp").component("panierDessin",{templateUrl:"app/pageDessin/panier-dessin/panier-dessin.html",bindings:{items:"<",effets:"<",addToTable:"&",removeToTable:"&",updateComposant:"&",onCompo:"&",onEffet:"&",leaveEffet:"&"},controller:a})}(),function(){angular.module("pedaleswitchApp").directive("tableDessin",["canvasControl","canvasDraw","mouseHelper","$rootScope",function(a,b,c,d){return{restrict:"E",templateUrl:"app/pageDessin/table-dessin/table-dessin.html",scope:{tableData:"=",tableMenu:"=",actions:"=",items:"<"},link:function(e,f){var g=document.getElementById("canvas-window"),h=document.getElementById("canvas-dessin"),i=h.getContext("2d");a.setCanvasWindow(g),a.setCanvas(h),a.setCtx(i),a.resizeCanvas(),a.getTableActive().length>0&&b.drawStuff(),h.addEventListener("mousemove",c.mouseMove),h.addEventListener("mouseup",c.mouseUpDefault),h.addEventListener("mousedown",c.mouseDown);var j=d.$on("click-on-border-boite",function(){h.removeEventListener("mouseup",c.mouseUpDefault),h.removeEventListener("mousemove",c.mouseMove),h.addEventListener("mousemove",c.mouseMoveBorderBoite),h.addEventListener("mouseup",c.mouseUp)}),k=d.$on("click-on-boite",function(){h.removeEventListener("mouseup",c.mouseUpDefault),h.removeEventListener("mousemove",c.mouseMove),h.addEventListener("mousemove",c.mouseMoveBoite),h.addEventListener("mouseup",c.mouseUp)}),l=d.$on("click-on-thing",function(){h.removeEventListener("mouseup",c.mouseUpDefault),h.removeEventListener("mousemove",c.mouseMove),h.addEventListener("mousemove",c.mouseMoveThing),h.addEventListener("mouseup",c.mouseUp)}),m=d.$on("click-on-deco",function(){h.removeEventListener("mouseup",c.mouseUpDefault),h.removeEventListener("mousemove",c.mouseMove),h.addEventListener("mousemove",c.mouseMoveDeco),h.addEventListener("mouseup",c.mouseUp)}),n=d.$on("click-on-corner-side-boite",function(){h.removeEventListener("mouseup",c.mouseUpDefault),h.removeEventListener("mousemove",c.mouseMove),h.addEventListener("mousemove",c.mouseMouveCornerSideBoite),h.addEventListener("mouseup",c.mouseUp)}),o=d.$on("no-click-on-element",function(){h.removeEventListener("mousemove",c.mouseMoveBorderBoite),h.removeEventListener("mousemove",c.mouseMoveBoite),h.removeEventListener("mousemove",c.mouseMoveThing),h.removeEventListener("mousemove",c.mouseMoveDeco),h.removeEventListener("mousemove",c.mouseMouveCornerSideBoite),h.removeEventListener("mouseup",c.mouseUp),h.removeEventListener("mousemove",c.mouseMoveColor),h.removeEventListener("mousedown",c.mouseDownColor),h.addEventListener("mouseup",c.mouseUpDefault),h.addEventListener("mousemove",c.mouseMove),h.addEventListener("mousedown",c.mouseDown)}),p=d.$on("color",function(){h.removeEventListener("mousemove",c.mouseMove),h.removeEventListener("mousemove",c.mouseMoveDeco),h.removeEventListener("mouseup",c.mouseUp),h.removeEventListener("mousedown",c.mouseDown),h.addEventListener("mousemove",c.mouseMoveColor),h.addEventListener("mousedown",c.mouseDownColor)});e.$on("$destroy",function(){j(),k(),l(),m(),n(),o(),p()})}}}])}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$http=b,c.socket.on("DummyJsonEvents:message",function(a){alert("Le serveur a un message pour vous : "+a)})}return a.$inject=["$http","socket"],_createClass(a,[{key:"randJson",value:function(){var a=this;this.$http.get("/api/dummyjsons/composant").then(function(b){a.json=b.data})}},{key:"randJson2",value:function(){var a=this;this.$http.get("/api/dummyjsons/effet").then(function(b){a.json=b.data})}}]),a}();angular.module("pedaleswitchApp").component("random",{templateUrl:"app/random/random.html",controller:a})}(),angular.module("pedaleswitchApp").config(["$stateProvider",function(a){a.state("random",{url:"/random",template:"<random></random>"})}]),angular.module("pedaleswitchApp").factory("rulers",function(){var a=.5,b=.2,c=10,d=15;return{fillContextWithRuler:function(a,b,c,e){var f=document.createElement("canvas"),g=f.getContext("2d");a.fillStyle=a.createPattern(b,"repeat-x"),a.fillRect(d,0,c,e),f.width=c,f.height=100,g.translate(0,0),g.scale(-1,1),g.rotate(Math.PI/4*2),g.drawImage(b,0,0),a.fillStyle=a.createPattern(f,"repeat-y"),a.fillRect(0,d,c,c)},constructSVGData:function(e,f,g){var h,i=parseInt(d*a,10),j=parseInt(d*b,10),k=parseInt(g/10,10),l="";for(h=0;c>h;h+=1)l+='<div xmlns="http://www.w3.org/1999/xhtml" style="position: absolute; bottom: 0px; width: '+k+"px; border-bottom: 1px solid #555; border-left: 1px solid #999;  height: "+(h%5===0?i:j)+"px; left: "+h*k+'px"></div>';return'<svg xmlns="http://www.w3.org/2000/svg" width="'+g+'" height="'+d+'"><foreignObject width="100%" height="100%">'+l+"</foreignObject></svg>"},render:function(a,b,c,e,f){var g,h,i,j,k;this.ctx=b,this.canvas=a,this.ctx.fillStyle="#474747",this.ctx.strokeStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.width,d),this.ctx.fillRect(0,0,d,this.canvas.height),h=this.constructSVGData.apply(this,[c,e,f]),i=document.createElement("img"),k=window.URL||window.webkitURL||window,i.onload=function(){k.revokeObjectURL(j),this.fillContextWithRuler(this.ctx,i,this.canvas.width,this.canvas.height)}.bind(this),g=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),j=k.createObjectURL(g),i.src=j},getRulersSize:function(){return d},drawGrid:function(a,b){var c=a.width,d=a.height;b.strokeStyle="rgba(94, 94, 94, 0.8)",b.beginPath();for(var e=0;c>e;e+=15)b.moveTo(e,0),b.lineTo(e,c);for(var f=0;d>f;f+=15)b.moveTo(0,f),b.lineTo(c,f);b.stroke()}}}),angular.module("pedaleswitchApp").factory("shareData",["$http",function(a){var b={},c={liste:[],data:[]};return{$http:a,pushdata:function(a,d){b[d._id]=d,b[d._id]._ideffet=a._id,b[d._id].type=a.type;var e,f=d.composants.length,g=[];for(e=0;f>e;++e)g=g.concat(d.composants[e].available_compo_id);var h=_.difference(g,c.liste);this.$http.post("/api/composants/all",h).then(function(a){a.data.forEach(function(a){c.liste.push(a._id)}),c.data=c.data.concat(a.data)})},getdata:function(){return b},removedata:function(){}}}]),angular.module("pedaleswitchApp").factory("storage",function(){return{init:function(){"undefined"!=typeof Storage},put:function(a,b){localStorage.setItem(a,JSON.stringify(b))},get:function(a){return JSON.parse(localStorage.getItem(a))}}});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),LoginController=function(){function a(b,c){_classCallCheck(this,a),this.user={},this.errors={},this.submitted=!1,this.Auth=b,this.$state=c}return a.$inject=["Auth","$state"],_createClass(a,[{key:"login",value:function(a){var b=this;this.submitted=!0,a.$valid&&this.Auth.login({email:this.user.email,password:this.user.password}).then(function(){b.$state.go("main")})["catch"](function(a){b.errors.other=a.message})}}]),a}();angular.module("pedaleswitchApp").controller("LoginController",LoginController),function(){function a(a,b,c,d,e,f,g){var h=f.safeCb,i={},j=e.userRoles||[];c.get("token")&&"/logout"!==a.path()&&(i=g.get());var k={login:function(a,e){var f=a.email,j=a.password;return b.post("/auth/local",{email:f,password:j}).then(function(a){return c.put("token",a.data.token),i=g.get(),i.$promise}).then(function(a){return h(e)(null,a),a})["catch"](function(a){return k.logout(),h(e)(a.data),d.reject(a.data)})},logout:function(){c.remove("token"),i={}},createUser:function(a,b){return g.save(a,function(d){return c.put("token",d.token),i=g.get(),h(b)(null,a)},function(a){return k.logout(),h(b)(a)}).$promise},changePassword:function(a,b,c){return g.changePassword({id:i._id},{oldPassword:a,newPassword:b},function(){return h(c)(null)},function(a){return h(c)(a)}).$promise},getCurrentUser:function(a){if(0===arguments.length)return i;var b=i.hasOwnProperty("$promise")?i.$promise:i;return d.when(b).then(function(b){return h(a)(b),b},function(){return h(a)({}),{}})},isLoggedIn:function(a){return 0===arguments.length?i.hasOwnProperty("role"):k.getCurrentUser(null).then(function(b){var c=b.hasOwnProperty("role");return h(a)(c),c})},hasRole:function l(a,b){var l=function(a,b){return j.indexOf(a)>=j.indexOf(b)};return arguments.length<2?l(i.role,a):k.getCurrentUser(null).then(function(c){var d=c.hasOwnProperty("role")?l(c.role,a):!1;return h(b)(d),d})},isAdmin:function(){return k.hasRole.apply(k,[].concat.apply(["admin"],arguments))},getToken:function(){return c.get("token")}};return k}a.$inject=["$location","$http","$cookies","$q","appConfig","Util","User"],angular.module("pedaleswitchApp.auth").factory("Auth",a)}(),function(){function a(a,b,c,d,e){var f;return{request:function(a){return a.headers=a.headers||{},c.get("token")&&e.isSameOrigin(a.url)&&(a.headers.Authorization="Bearer "+c.get("token")),a},responseError:function(a){return 401===a.status&&((f||(f=d.get("$state"))).go("login"),c.remove("token")),b.reject(a)}}}a.$inject=["$rootScope","$q","$cookies","$injector","Util"],angular.module("pedaleswitchApp.auth").factory("authInterceptor",a)}(),function(){angular.module("pedaleswitchApp.auth").run(["$rootScope","$state","Auth",function(a,b,c){a.$on("$stateChangeStart",function(a,d){d.authenticate&&("string"==typeof d.authenticate?c.hasRole(d.authenticate,_.noop).then(function(d){return d?void 0:(a.preventDefault(),c.isLoggedIn(_.noop).then(function(a){b.go(a?"main":"login")}))}):c.isLoggedIn(_.noop).then(function(c){c||(a.preventDefault(),b.go("main"))}))})}])}(),function(){function a(a){return a("/api/users/:id/:controller",{id:"@_id"},{changePassword:{method:"PUT",params:{controller:"password"}},get:{method:"GET",params:{id:"me"}}})}a.$inject=["$resource"],angular.module("pedaleswitchApp.auth").factory("User",a)}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(){_classCallCheck(this,a),this.editMode=!1,this.fieldValueCopy=""}return _createClass(a,[{key:"$onInit",value:function(){this.fieldValueCopy=this.fieldValue,this.fieldType||(this.fieldType="text")}},{key:"handleModeChange",value:function(){this.editMode&&this.fieldValue!==this.fieldValueCopy&&this.onUpdate({value:this.fieldValue}),this.editMode=!this.editMode}}]),a}();angular.module("pedaleswitchApp").component("editablefield",{templateUrl:"components/editablefield/editablefield.html",bindings:{fieldValue:"<",fieldType:"@?",onUpdate:"&"},controller:a})}(),angular.module("pedaleswitchApp").directive("footer",function(){return{templateUrl:"components/footer/footer.html",restrict:"E",link:function(a,b){b.addClass("footer")}}}),angular.module("pedaleswitchApp").factory("Modal",["$rootScope","$uibModal",function(a,b){function c(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],d=arguments.length<=1||void 0===arguments[1]?"modal-default":arguments[1],e=a.$new();return angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(){var a=arguments.length<=0||void 0===arguments[0]?angular.noop:arguments[0];return function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}}}}]),angular.module("pedaleswitchApp").directive("mongooseError",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){return d.$setValidity("mongoose",!0)})}}});var NavbarController=function a(b){_classCallCheck(this,a),this.menu=[{title:"Home",state:"main"},{title:"Composant",state:"composant"},{title:"Effets",state:"addeffet"},{title:"RemplirDb",state:"random"},{title:"BibliothÃ¨que",state:"bibliotheque"},{title:"Dessin",state:"pageDessin"}],this.isCollapsed=!0,this.isLoggedIn=b.isLoggedIn,this.isAdmin=b.isAdmin,this.getCurrentUser=b.getCurrentUser};NavbarController.$inject=["Auth"],angular.module("pedaleswitchApp").controller("NavbarController",NavbarController),angular.module("pedaleswitchApp").directive("navbar",function(){return{templateUrl:"components/navbar/navbar.html",restrict:"E",controller:"NavbarController",controllerAs:"nav"}}),angular.module("pedaleswitchApp").factory("socket",["socketFactory","OrderArray",function(a,b){var c=io("",{path:"/socket.io-client"}),d=a({ioSocket:c});return{socket:d,OrderArray:b,syncUpdates:function(a,c,e){e=e||angular.noop,d.on(a+":save",function(a){var d,f=b.boucle(c,"_id",a._id,3);if(f){f.pop();var g=f[f.length-1];f.pop();var h=b.returnsubarray(c,f);h.splice(g,1,a),d="updated"}else d="created",angular.isArray(c)?c.push(a):c[a.type].push(a);e(d,a,c)}),d.on(a+":remove",function(a){var d="deleted",f=_.remove(c,{_id:a._id});if(0===f.length){var g=b.boucle(c,"_id",a._id,3);g.pop(),g.length>1&&b.supwithpath(c,g)}e(d,a,c)})},unsyncUpdates:function(a){d.removeAllListeners(a+":save"),d.removeAllListeners(a+":remove")}}}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),SettingsController=function(){function a(b){_classCallCheck(this,a),this.errors={},this.submitted=!1,this.Auth=b}return a.$inject=["Auth"],_createClass(a,[{key:"changePassword",value:function(a){var b=this;this.submitted=!0,a.$valid&&this.Auth.changePassword(this.user.oldPassword,this.user.newPassword).then(function(){b.message="Password successfully changed."})["catch"](function(){a.password.$setValidity("mongoose",!1),b.errors.other="Incorrect password",b.message=""})}}]),a}();angular.module("pedaleswitchApp").controller("SettingsController",SettingsController),function(){function a(a){var b={safeCb:function(a){return angular.isFunction(a)?a:angular.noop},urlParse:function(a){var b=document.createElement("a");return b.href=a,""===b.host&&(b.href=b.href),b},isSameOrigin:function(c,d){return c=b.urlParse(c),d=d&&[].concat(d)||[],d=d.map(b.urlParse),d.push(a.location),d=d.filter(function(a){return c.hostname===a.hostname&&c.port===a.port&&c.protocol===a.protocol}),d.length>=1}};return b}a.$inject=["$window"],angular.module("pedaleswitchApp.util").factory("Util",a)}(),angular.module("pedaleswitchApp").run(["$templateCache",function(a){a.put("app/account/login/login.html",'<div class=container><div class=row><div class=col-sm-12><h1>Login</h1><p>Accounts are reset on server restart from <code>server/config/seed.js</code>. Default account is <code>test@example.com</code> / <code>test</code></p><p>Admin account is <code>admin@example.com</code> / <code>admin</code></p></div><div class=col-sm-12><form class=form name=form ng-submit=vm.login(form) novalidate><div class=form-group><label>Email</label><input type=email name=email class=form-control ng-model=vm.user.email required></div><div class=form-group><label>Password</label><input type=password name=password class=form-control ng-model=vm.user.password required></div><div class="form-group has-error"><p class=help-block ng-show="form.email.$error.required && form.password.$error.required && vm.submitted">Please enter your email and password.</p><p class=help-block ng-show="form.email.$error.email && vm.submitted">Please enter a valid email.</p><p class=help-block>{{ vm.errors.other }}</p></div><div><button class="btn btn-inverse btn-lg btn-login" type=submit>Login</button> <a class="btn btn-default btn-lg btn-register" ui-sref=signup>Register</a></div></form></div></div><hr></div>'),a.put("app/account/settings/settings.html",'<div class=container><div class=row><div class=col-sm-12><h1>Change Password</h1></div><div class=col-sm-12><form class=form name=form ng-submit=vm.changePassword(form) novalidate><div class=form-group><label>Current Password</label><input type=password name=password class=form-control ng-model=vm.user.oldPassword mongoose-error><p class=help-block ng-show=form.password.$error.mongoose>{{ vm.errors.other }}</p></div><div class=form-group><label>New Password</label><input type=password name=newPassword class=form-control ng-model=vm.user.newPassword ng-minlength=3 required><p class=help-block ng-show="(form.newPassword.$error.minlength || form.newPassword.$error.required) && (form.newPassword.$dirty || vm.submitted)">Password must be at least 3 characters.</p></div><div class=form-group><label>Confirm New Password</label><input type=password name=confirmPassword class=form-control ng-model=vm.user.confirmPassword match=vm.user.newPassword ng-minlength=3 required><p class=help-block ng-show="form.confirmPassword.$error.match && vm.submitted">Passwords must match.</p></div><p class=help-block>{{ vm.message }}</p><button class="btn btn-lg btn-primary" type=submit>Save changes</button></form></div></div></div>'),a.put("app/account/signup/signup.html",'<div class=container><div class=row><div class=col-sm-12><h1>Sign up</h1></div><div class=col-sm-12><form class=form name=form ng-submit=vm.register(form) novalidate><div class=form-group ng-class="{ \'has-success\': form.name.$valid && vm.submitted,\n                                            \'has-error\': form.name.$invalid && vm.submitted }"><label>Name</label><input name=name class=form-control ng-model=vm.user.name required><p class=help-block ng-show="form.name.$error.required && vm.submitted">A name is required</p></div><div class=form-group ng-class="{ \'has-success\': form.email.$valid && vm.submitted,\n                                            \'has-error\': form.email.$invalid && vm.submitted }"><label>Email</label><input type=email name=email class=form-control ng-model=vm.user.email required mongoose-error><p class=help-block ng-show="form.email.$error.email && vm.submitted">Doesn\'t look like a valid email.</p><p class=help-block ng-show="form.email.$error.required && vm.submitted">What\'s your email address?</p><p class=help-block ng-show=form.email.$error.mongoose>{{ vm.errors.email }}</p></div><div class=form-group ng-class="{ \'has-success\': form.password.$valid && vm.submitted,\n                                            \'has-error\': form.password.$invalid && vm.submitted }"><label>Password</label><input type=password name=password class=form-control ng-model=vm.user.password ng-minlength=3 required mongoose-error><p class=help-block ng-show="(form.password.$error.minlength || form.password.$error.required) && vm.submitted">Password must be at least 3 characters.</p><p class=help-block ng-show=form.password.$error.mongoose>{{ vm.errors.password }}</p></div><div class=form-group ng-class="{ \'has-success\': form.confirmPassword.$valid && vm.submitted,\n                                            \'has-error\': form.confirmPassword.$invalid && vm.submitted }"><label>Confirm Password</label><input type=password name=confirmPassword class=form-control ng-model=vm.user.confirmPassword match=vm.user.password ng-minlength=3 required><p class=help-block ng-show="form.confirmPassword.$error.match && vm.submitted">Passwords must match.</p></div><div><button class="btn btn-inverse btn-lg btn-register" type=submit>Sign up</button> <a class="btn btn-default btn-lg btn-login" ui-sref=login>Login</a></div></form></div></div><hr></div>'),a.put("app/addeffet/addeffet/addeffet.html","<effet types=$ctrl.types></effet><addtype types=$ctrl.types></addtype>"),a.put("app/addeffet/editeffet/editeffet.html",'<h1 class=page-header>EDITER EFFET</h1><form class=form><div class=form-group><div>Editer l\'effet "{{$ctrl.entity.titre}}"</div><a ui-sref=addeffet><button type=button class=close>&times;</button></a><label>Nom :</label><input class=form-control placeholder="nom de l\'effet" ng-model=$ctrl.entity.titre><label>Description :</label><input class=form-control placeholder="description de l\'effet" ng-model=$ctrl.entity.description><label>Type :</label><select class=form-control ng-model=$ctrl.entity.type><option ng-repeat="type in $ctrl.types" value={{type.titre}}>{{type.titre}}</option></select><options effet=$ctrl.entity nouv-effet=$ctrl.nouv></options></div><span class=input-group-btn><button type=submit class="btn btn-primary" ng-click=$ctrl.onAction($ctrl.nouv)>{{$ctrl.nouv ? \'Enregistrer\' : \'Enregistrer\'}}</button> <button type=submit class="btn btn-danger" ng-click=$ctrl.deleteEffet($ctrl.entity) ng-hide=$ctrl.nouv>Supprimer</button></span></form>'),a.put("app/addeffet/effet/effet.html",'g<div class=container><div ui-view></div><div class=row><div class=col-lg-12><div><h1 class=page-header>EFFETS</h1><a ui-sref="addeffet.edit({entity: {}, types: $ctrl.types, nouv: true})"><button type=button class="btn btn-primary">Nouvel effet</button></a></div><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="effet in $ctrl.indexEffets"><li><a ui-sref="addeffet.edit({entity: effet, types: $ctrl.types, nouv: false})" uib-tooltip="INFO: {{effet.description}} TYPE: {{effet.type}}">{{effet.titre}}</a></li></ul></div></div></div>'),
a.put("app/addeffet/listeComposants/listeComposants.html",'<!--<div name="listCompoForm">--><!--<div ng-repeat="(k, v) in $ctrl.listeCompo">--><!--<h2>{{k}}</h2>--><!--<div class="list-group">--><!--<label class="list-group-item" ng-repeat="compo in v">--><!--<input type="checkbox" ng-model="compo.value">--><!--{{compo.titre}}--><!--</label>--><!--</div>--><!--</div>--><!--<div class="modal-footer">--><!--<button class="btn btn-primary" type="button" ng-click="$ctrl.validation()">OK</button>--><!--<button class="btn btn-warning" type="button" ng-click="$ctrl.annuler()">Annuler</button>--><!--</div>--><!--</form>--><div name=listCompoForm><div ng-repeat="(k, v) in $ctrl.listeCompo"><h2>{{k}}</h2><div class=btn-group><label class="btn btn-default" ng-repeat="compo in v" ng-model=compo.value uib-btn-checkbox>{{compo.titre}}</label></div></div><div class=modal-footer><button class="btn btn-primary" type=button ng-click=$ctrl.validation()>OK</button> <button class="btn btn-warning" type=button ng-click=$ctrl.annuler()>Annuler</button></div></div>'),a.put("app/addeffet/modalComposants/modalBox.html","<liste-composants ok=modal.ok(selected) cancel=modal.cancel() saved=modal.saved></liste-composants>"),a.put("app/addeffet/modalComposants/modalComposants.html",'<p class=input-group><span class=input-group-btn><button type=submit class="btn btn-default" ng-click="$ctrl.open(\'lg\')">Ajouter Ã©lÃ©ments</button></span> <input class=form-control placeholder="Choisis parmis la liste des composants disponibles" ng-model=$ctrl.oneComposant.available_compo_id></p>'),a.put("app/addeffet/optionComposants/optionComposants.html",'<uib-tabset active=0><uib-tab index=$index ng-repeat="composant in $ctrl.oneOption.composants track by $index" heading="Comp. {{$index + 1}} - {{composant.titre}}"><label>Type de composant :</label><select class=form-control ng-model=$ctrl.oneOption.composants[$index].type><option ng-repeat="type in $ctrl.typeCompo" value={{type.titre}}>{{type.titre}}</option></select><label>Nom du composant :</label><input class=form-control placeholder="nom du composant" ng-model=$ctrl.oneOption.composants[$index].titre><label>Choix de composants possibles :</label><modal-composants one-composant=$ctrl.oneOption.composants[$index]></modal-composants><label>Position x :</label><input class=form-control placeholder="coord. X" ng-model=$ctrl.oneOption.composants[$index].pos.x><label>Position y :</label><input class=form-control placeholder="coord. Y" ng-model=$ctrl.oneOption.composants[$index].pos.y><div class=btn-group><button type=submit class="btn btn-primary" ng-click=$ctrl.newComposant()>+ compo</button> <button type=submit class="btn btn-danger" ng-click=$ctrl.deleteComposant($index)>- compo</button></div></uib-tab></uib-tabset>'),a.put("app/addeffet/options/options.html",'<uib-tabset active=0><uib-tab index=$index ng-repeat="option in $ctrl.effet.options track by $index" heading="Option {{$index + 1}} - {{option.titre}}"><label>Nom de l\'option :</label><input class=form-control placeholder="nom de l\'option" ng-model=$ctrl.effet.options[$index].titre><label>Description :</label><input class=form-control placeholder=description ng-model=$ctrl.effet.options[$index].description><label>Prix :</label><input class=form-control placeholder=prix ng-model=$ctrl.effet.options[$index].prix><label>Largueur :</label><input class=form-control placeholder="largeur de l\'option" ng-model=$ctrl.effet.options[$index].size.w><label>Hauteur :</label><input class=form-control placeholder="hauteur de l\'option" ng-model=$ctrl.effet.options[$index].size.h><option-composants one-option=$ctrl.effet.options[$index] nouvoption=$ctrl.nouvoption></option-composants><div class=btn-group><button type=submit class="btn btn-primary" ng-click=$ctrl.newOption() ng-hide=$ctrl.nouv>+ Option</button> <button type=submit class="btn btn-danger" ng-click=$ctrl.deleteOption($index) ng-hide=$ctrl.nouv>- Option</button></div></uib-tab></uib-tabset>'),a.put("app/addeffet/type/addtype.html",'<div class=container><div class=row><div class=col-lg-12><h1 class=page-header>TYPES EFFETS</h1><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="type in $ctrl.types"><li><a href=# uib-tooltip={{type.info}}><button type=button class=close ng-click=$ctrl.deleteTypeEffet(type)>&times;</button><editablefield field-value=type.titre field-type=text on-update="$ctrl.updateTypeEffet(type, value)"></editablefield></a></li></ul></div></div><form class=effet-form><label>Ajouter un type d\'effet</label><p class=input-group><input class=form-control placeholder="Nom du type d\'effet" ng-model=$ctrl.newTypeEffet.titre> <span class=input-group-btn><button type=submit class="btn btn-primary" ng-click=$ctrl.addTypeEffet()>Ajouter</button></span></p></form></div>'),a.put("app/admin/admin.html",'<div class=container><p>The delete user and user index api routes are restricted to users with the \'admin\' role.</p><ul class="list-group user-list"><li class=list-group-item ng-repeat="user in admin.users"><div class=user-info><strong>{{user.name}}</strong><br><span class=text-muted>{{user.email}}</span></div><a ng-click=admin.delete(user) class=trash><span class="fa fa-trash fa-2x"></span></a></li></ul></div>'),a.put("app/bibliotheque-compo/bib-compo-desc/bib-compo-desc.html","<div class=list-group><h3 class=list-group-item>{{ $ctrl.items[$ctrl.op].titre }}</h3><div class=list-group-item>Type: {{$ctrl.items[$ctrl.op].type}}</div><div class=list-group-item>Info: {{$ctrl.items[$ctrl.op].description}}</div><div class=list-group-item>Tarif unitaire: {{$ctrl.items[$ctrl.op].prix_additionnel}}</div><div class=list-group-item>Taille: {{$ctrl.items[$ctrl.op].size.h}} x {{$ctrl.items[$ctrl.op].size.w}}</div></div>"),a.put("app/bibliotheque-compo/bib-compo-item/bib-compo-item.html",'<div><label ng-repeat="option in $ctrl.options" class="btn btn-primary btn-block" ng-model=$ctrl.selectoption uib-btn-radio=option>{{ ::$ctrl.items[option].titre }}</label></div>'),a.put("app/bibliotheque/bib-description/bib-description.html",'<div class=list-group ng-show=$ctrl.op.titre><!--<h3>Description</h3>--><h2 class=list-group-item>{{$ctrl.eff.titre}} - {{$ctrl.op.titre}}</h2><div class=list-group-item>Type: {{$ctrl.eff.type}}</div><div class=list-group-item>Info generale: {{$ctrl.eff.description}}</div><div class=list-group-item>A propos de l\'option: {{$ctrl.op.description}}</div><div class=list-group-item>Tarif unitaire: {{$ctrl.op.prix}}</div><div class=list-group-item>Taille: {{$ctrl.op.size.h}} x {{$ctrl.op.size.w}}</div><div class=list-group-item>Composants:<div ng-repeat="compo in $ctrl.op.composants">- {{compo.titre}} [{{compo.type}}]</div></div><div class=btn-group><button type=submit class="btn btn-warning" ng-click=$ctrl.addEffet()>Ajouter l\'effet</button> <a class="btn btn-default" ui-sref="addeffet.edit({entity: $ctrl.eff, types: \'\', nouv: false})">Ã©diter</a></div></div>'),a.put("app/bibliotheque/bib-effet/bib-effet.html",'<h3>Effets</h3><uib-accordion><uib-accordion-group heading={{k}} ng-repeat="(k, v) in $ctrl.effets"><label class="btn btn-primary btn-block" ng-repeat="effet in v" ng-model=$ctrl.selecteffet ng-click=$ctrl.chgmteffet({value:$ctrl.selecteffet}) uib-btn-radio=effet>{{effet.titre}}</label></uib-accordion-group></uib-accordion>'),a.put("app/bibliotheque/bib-option/bib-option.html",'<div ng-show=$ctrl.selectoption.titre><h3>Options</h3><label class="btn btn-info btn-block" ng-repeat="option in $ctrl.options" ng-model=$ctrl.selectoption uib-btn-radio=option>{{option.titre}}</label></div>'),a.put("app/bibliotheque/bibliotheque.html",'<div class=container-fluid><div class=row><div class=col-xs-3><bib-effet effets=$ctrl.effets chgmteffet=$ctrl.chgmtEffet(value)></bib-effet></div><div class=col-xs-3><bib-option options=$ctrl.selecteffet.options selectoption=$ctrl.selectoption></bib-option></div><div class=col-xs-6><bib-description op=$ctrl.selectoption eff=$ctrl.selecteffet></bib-description></div></div></div><!--<div class="container-fluid">--><!--<div class="row">--><!--<div class="col-xs-3">--><!--<bib-effet effets="$ctrl.effets" selecteffet="$ctrl.selecteffet"></bib-effet>--><!--</div>--><!--<div class="col-xs-3">--><!--<bib-option options="$ctrl.selecteffet.options" selectoption="$ctrl.selectoption"></bib-option>--><!--</div>--><!--<div class="col-xs-6">--><!--<bib-description op="$ctrl.selectoption" eff="$ctrl.selecteffet"></bib-description>--><!--</div>--><!--</div>--><!--</div>-->'),a.put("app/composant/composant.html",'<div class=container loading3=$ctrl.loading><composant-type composant-types=$ctrl.composantTypes></composant-type><h1 class=page-header>Liste de Composants :</h1><uib-accordion><uib-accordion-group heading={{k}} ng-repeat="(k, v) in $ctrl.composants"><ul ng-repeat="composant in v"><li><a href=# uib-tooltip={{composant.description}}>{{composant.titre}}<br>Type : {{composant.type}}<br>Forme : {{composant.shape}}<br>Prix : {{composant.prix_additionnel}}euro<br>Dimension : {{composant.size.w}} x {{composant.size.h}} <button type=button class=close ng-click=$ctrl.deleteComposant(composant)>&times;</button></a></li></ul></uib-accordion-group></uib-accordion><form class=thing-form><h2>Ajouter un composant dans la db</h2><label>Nom :</label><input class=form-control placeholder=Nom ng-model=$ctrl.newComposant.titre><label>Type de composant :</label><select ng-model=$ctrl.newComposant.type><option ng-repeat="composantType in $ctrl.composantTypes">{{composantType.titre}}</option></select><label>Forme :</label><input class=form-control placeholder="(Rect, Cercle, Poly)" ng-model=$ctrl.newComposant.shape><label>Description :</label><input class=form-control placeholder=Description. ng-model=$ctrl.newComposant.description><label>Disponible :</label><input type=checkbox ng-model=$ctrl.newComposant.disponible><label>Prix :</label><input class=form-control placeholder=Prix. ng-model=$ctrl.newComposant.prix_additionnel><label>Largueur :</label><input class=form-control placeholder=Largueur ng-model=$ctrl.newComposant.size.w><label>Hauteur :</label><input class=form-control placeholder=Hauteur ng-model=$ctrl.newComposant.size.h> <button type=submit class="btn btn-primary" ng-click=$ctrl.addComposant()>Add New</button></form></div>'),a.put("app/composantType/composantType.html",'<div><div class=row><div class=col-lg-12><h1 class=page-header>Liste des Types de Composants :</h1><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="composantType in $ctrl.composantTypes"><li><a href=#>{{composantType.titre}} <button type=button class=close ng-click=$ctrl.deleteComposantType(composantType)>&times;</button></a> <input type=checkbox class=edit ng-model=composantType.checked><div ng-show=composantType.checked><input ng-model=composantType.titre> <button type=button class="btn btn-primary" ng-click=$ctrl.updateComposantType(composantType)>Save Modif</button></div></li></ul></div></div><form class=thing-form><label>Ajouter un type de composant dans la db</label><p class=input-group><input class=form-control placeholder=Titre. ng-model=$ctrl.newComposantType.titre></p><button type=submit class="btn btn-primary" ng-click=$ctrl.addComposantType()>Add New</button></form></div>'),a.put("app/draggable/draggable.html","<div>this is the draggable directive</div>"),a.put("app/droppable/droppable.html","<div>this is the droppable directive</div>"),a.put("app/main/main.html",'<header class=hero-unit id=banner><div class=container><h1>\'Allo, \'Allo!</h1><p class=lead>Kick-start your next web app with Angular Fullstack</p><img src=assets/images/yeoman.462ccecb.png alt="I\'m Yeoman"></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Features:</h1><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="thing in $ctrl.awesomeThings"><li><a href=# uib-tooltip={{thing.info}}>{{thing.name}}<button type=button class=close ng-click=$ctrl.deleteThing(thing)>&times;</button></a></li></ul></div></div><form class=thing-form><label>Syncs in realtime across clients</label><p class=input-group><input class=form-control placeholder="Add a new thing here." ng-model=$ctrl.newThing> <span class=input-group-btn><button type=submit class="btn btn-primary" ng-click=$ctrl.addThing()>Add New</button></span></p></form></div>'),a.put("app/pageDessin/box-dessin/box-arrow/box-arrow.html",'<div class="input-group input-group-sm" style=width:140px><input type=number class=form-control ng-model=$ctrl.value ng-focus=$ctrl.onFocus() ng-blur=$ctrl.onBlur() placeholder={{$ctrl.datas.value}} min=20 max=1500 required> <span class=input-group-addon id=basic-addon1>mm</span> <span class=input-group-btn><button type=submit class="btn btn-primary" ng-click=$ctrl.validation() ng-show=$ctrl.change>Ok</button></span></div>'),a.put("app/pageDessin/box-dessin/box-dessin.html",'<div style="top:{{ $ctrl.data.posBox.y }}px;\n    left:{{ $ctrl.data.posBox.x }}px;\n    z-index:{{ ::$ctrl.zIndex }};\n    position:absolute"><div ng-transclude></div></div>'),a.put("app/pageDessin/box-dessin/option-box-popover-composant.html",'<div><div class=row><div class=col-lg-12><p><span ng-bind=::$ctrl.data.titreParentEffet></span> - <span ng-bind=::$ctrl.data.titreParentOption></span> #{{::$ctrl.data.key + 1}}</p></div></div><modif-dessin data=$ctrl.data actions=$ctrl.actions></modif-dessin><div class=row><div class=col-lg-12><p><label>Composant:</label><span ng-bind=::$ctrl.data.itemInfo.titreItem></span></p><p><modal-dessin name="Changer le composant" template=modalBox class-btn="btn btn-default btn-sm" actions=$ctrl.actions items=$ctrl.items data=$ctrl.data selected></modal-dessin></p></div></div></div>'),a.put("app/pageDessin/box-dessin/option-box-popover-effet.html",'<div><div class=row><div class=col-lg-12><p><span ng-bind=::$ctrl.data.titre></span> - <span ng-bind=::$ctrl.data.titreOption></span> #{{::$ctrl.data.key + 1}}</p></div></div><modif-dessin data=$ctrl.data actions=$ctrl.actions></modif-dessin><div ng-repeat="composant in $ctrl.data.composants"><div class=row><div class=col-lg-12><p><label ng-bind=::composant.titre></label><div ng-bind=::composant.itemInfo.titreItem></div></p><p><label>Composant:</label><span ng-bind=::composant.itemInfo.titreItem></span></p><p><modal-dessin name="Changer le composant" template=modalBox class-btn="btn btn-default btn-sm" action="$ctrl.boxAction({compo:compo, value:value})" items=$ctrl.items data=composant selected></modal-dessin></p></div></div></div></div>'),a.put("app/pageDessin/box-dessin/option-box-popover-forme.html",""),a.put("app/pageDessin/box-dessin/option-box-popover-image.html",""),a.put("app/pageDessin/box-dessin/option-box-popover-texte.html","<modif-dessin data=$ctrl.data actions=$ctrl.actions></modif-dessin>"),a.put("app/pageDessin/deco-dessin/deco-dessin.html",'<h3>Edition graphique</h3><ul ng-repeat="item in $ctrl.items"><li>{{item.input}}</li></ul><input name=text ng-model=string><br><button type=submit class="btn btn-primary btn-sm" ng-click="$ctrl.addTextToTable({string: string})">+</button>'),a.put("app/pageDessin/menu-dessin/menu-dessin.html",'<button type=button class="btn btn-primary" ng-model=$ctrl.deco ng-click=$ctrl.switchDeco() uib-btn-checkbox>Mode dÃ©coration</button> <button ng-hide=$ctrl.deco type=button class="btn btn-primary" ng-model=$ctrl.debrayable ng-click=$ctrl.switchDeb() uib-btn-checkbox>Composants positionnables</button><div class=btn-group><label class="btn btn-success" ng-click=$ctrl.activeEffet() ng-model=$ctrl.isActive uib-btn-radio="\'effet\'" uncheckable ng-hide="!$ctrl.debrayable || $ctrl.deco">Deplacer les effets</label><label class="btn btn-success" ng-click=$ctrl.activeCompo() ng-model=$ctrl.isActive uib-btn-radio="\'composant\'" uncheckable ng-hide="!$ctrl.debrayable || $ctrl.deco">Deplacer les composants</label></div>'),a.put("app/pageDessin/modal-dessin/modal-dessin.html","<button type=submit class={{::$ctrl.classBtn}} ng-click=\"$ctrl.open('lg')\">{{::$ctrl.name}}</button>"),a.put("app/pageDessin/modal-dessin/modalBiblioBox.html","<bibliotheque></bibliotheque>"),a.put("app/pageDessin/modal-dessin/modalBox.html",'<div class=container-fluid><h2 class=text-center>Composants</h2><div class=row><div class=col-xs-4><bib-compo-item items=modal.items options=modal.data.itemInfo.items selectoption=modal.selected></bib-compo-item></div><div class=col-xs-8><bib-compo-desc items=modal.items op=modal.selected></bib-compo-desc></div></div><div class=row><div class="col-xs-3 col-xs-offset-9"><button class="btn btn-primary" type=button ng-click=modal.ok()>OK</button> <button class="btn btn-warning" type=button ng-click=modal.cancel()>Annuler</button></div></div></div>'),a.put("app/pageDessin/modif-dessin/modif-dessin.html",'<div ng-if=$ctrl.data.input><span style=font-family:{{$ctrl.data.font.family}}>{{$ctrl.data.input}}</span> <button type=button class="btn btn-primary" ng-model=$ctrl.data.isVertical ng-click=$ctrl.data.changeOrientation();$ctrl.actions.dataChange($ctrl.data) uib-btn-checkbox>Vertical</button><br><jd-fontselect stack=$ctrl.data.font.family on-change="$ctrl.actions.changeFont(font, $ctrl.data)" on-close="$ctrl.actions.dataChange($ctrl.data)">Texte :<input class=form-control ng-model=$ctrl.data.input ng-change=$ctrl.actions.dataChange($ctrl.data) required> Taille :<input type=number min=1 class=form-control placeholder={{$ctrl.data.font.size}} ng-model=$ctrl.data.font.size ng-change=$ctrl.actions.dataChange($ctrl.data) required><color-picker ng-model=$ctrl.data.font.color color-picker-disabled=false color-picker-format="\'hex\'" color-picker-on-change=$ctrl.actions.dataChange($ctrl.data)></color-picker><button type=button class="btn btn-default" ng-click=$ctrl.actions.eyeDropper()>Pipette</button></div><div class=btn-group><button type=button class="btn btn-default" ng-click="$ctrl.actions.rotate(5, $ctrl.data)">Rotation Gauche</button> <button type=button class="btn btn-default" ng-click="$ctrl.actions.rotate(-5, $ctrl.data)">Rotation Droite</button></div>'),a.put("app/pageDessin/navigation-dessin/navigation-dessin.html",'<div class=btn-group><button type=button class="btn btn-default" ng-click=$ctrl.zoomAdd({value:-0.2})>Zoom -</button> <button type=button class="btn btn-default">{{$ctrl.zoom}}%</button> <button type=button class="btn btn-default" ng-click=$ctrl.zoomAdd({value:0.2})>Zoom +</button></div><div class=btn-group><button type=button class="btn btn-default" ng-click=$ctrl.save()>Enregistrer</button> <button type=button class="btn btn-default" ng-click=$ctrl.load()>Charger</button></div><div class=btn-group><button type=button class="btn btn-default" ng-click=$ctrl.up()>Dessus</button> <button type=button class="btn btn-default" ng-click=$ctrl.down()>Dessous</button> <button type=button class="btn btn-default" ng-click=$ctrl.right()>Droite</button> <button type=button class="btn btn-default" ng-click=$ctrl.left()>Gauche</button> <button type=button class="btn btn-default" ng-click=$ctrl.bottom()>Devant</button> <button type=button class="btn btn-default" ng-click=$ctrl.top()>DerriÃ¨re</button></div>'),a.put("app/pageDessin/pageDessin.html",'<button type=button class="btn btn-primary" ng-click=$ctrl.getTable()>getTable</button><div class=container-fluid><div class=col-xs-12><modal-dessin name="Ajouter un effet" class-btn="btn btn-default" template=modalBiblioBox></modal-dessin><menu-dessin deco=$ctrl.deco switch-deco=$ctrl.switchDeco() debrayable=$ctrl.debrayable switch-deb=$ctrl.switchDeb() active-effet=$ctrl.activeEffet() active-compo=$ctrl.activeCompo() is-active=$ctrl.isActive></menu-dessin><navigation-dessin zoom=$ctrl.zoom zoom-add=$ctrl.zoomAdd(value) load=$ctrl.load() save=$ctrl.save() up=$ctrl.up() down=$ctrl.down() left=$ctrl.left() right=$ctrl.right() top=$ctrl.top() bottom=$ctrl.bottom()></navigation-dessin></div><div class=row><div class=col-xs-3><panier-dessin ng-hide=$ctrl.deco items=$ctrl.items effets=$ctrl.dessin.options on-compo=$ctrl.mouseOnCompo(value) on-effet=$ctrl.mouseOnEffet(value) leave-effet=$ctrl.mouseLeaveEffet() update-composant="$ctrl.updateComposant(compo, value)" add-to-table=$ctrl.addToTable(value) remove-to-table=$ctrl.removeToTable(value)></panier-dessin><deco-dessin ng-show=$ctrl.deco items=$ctrl.tableText add-text-to-table=$ctrl.addTextToTable(string)></deco-dessin></div><div class=col-xs-3><table-dessin datachange="$ctrl.dataChange(value, data)" table-data=$ctrl.tableArrow table-menu=$ctrl.activeItem items=$ctrl.items actions=$ctrl.funcMenuPopOver></table-dessin></div></div></div>'),a.put("app/pageDessin/panier-dessin/panier-dessin.html",'<h3>Panier des effets</h3><uib-accordion><uib-accordion-group ng-repeat="effet in $ctrl.effets" ng-mouseleave=$ctrl.leaveEffet() ng-mouseenter=$ctrl.onEffet({value:effet}) draggable heading="{{::effet.titre}} - {{::effet.titreOption}} #{{::effet.key + 1}}"><div ng-mouseleave=$ctrl.leaveEffet() ng-mouseenter=$ctrl.onCompo({value:compo}) ng-repeat="(k, compo) in effet.composants"><p><label>{{compo.titre}}</label>- {{compo.itemInfo.titreItem}}</p><p><modal-dessin template=modalBox name="Changer le composant" class-btn="btn btn-default btn-sm" action="$ctrl.updateComposant({compo:compo, value:value})" items=$ctrl.items data=compo selected></modal-dessin></p></div><p>{{effet.description}}</p><p>{{effet.descriptionOption}}</p><button ng-hide=effet.inCanvas type=submit class="btn btn-primary btn-sm" ng-click="$ctrl.addToTable({value: effet})">+</button> <button ng-show=effet.inCanvas type=submit class="btn btn-primary btn-sm" ng-click="$ctrl.removeToTable({value: effet})">-</button></uib-accordion-group></uib-accordion>'),a.put("app/pageDessin/table-dessin/table-dessin.html",'<h3>Dessin</h3><div id=canvas-window style="overflow: scroll; position:relative" ng-mousemove="" ng-click=""><box-dessin ng-repeat="item in tableData" data=item actions=actions><box-arrow datas=item actions=actions></box-arrow></box-dessin><box-dessin ng-repeat="menu in tableMenu" data=menu actions=actions items=items><div style="width:{{ $ctrl.data.size.w }}px;height:{{ $ctrl.data.size.h }}px; background:black" uib-popover-template=$ctrl.popUpUrl popover-append-to-body=true popover-is-open=true popover-title="{{ ::$ctrl.data.titre }}" popover-placement=right></div></box-dessin><canvas droppable id=canvas-dessin style=position:relative;background-color:#f1f1f1>Ooups, Votre navigateur ne supporte pas le html 5...</canvas></div>'),a.put("app/random/random.html",'<div class=container><button type=submit class="btn btn-primary" ng-click=$ctrl.randJson()>remplir composant</button> <button type=submit class="btn btn-primary" ng-click=$ctrl.randJson2()>remplir effet</button></div>'),a.put("components/editablefield/editablefield.html","<span ng-switch=$ctrl.editMode><input ng-switch-when=true type={{$ctrl.fieldType}} ng-model=$ctrl.fieldValue> <span ng-switch-default>{{$ctrl.fieldValue}}</span></span> <button type=button class=close ng-click=$ctrl.handleModeChange()>{{$ctrl.editMode ? 'ok' : '+'}}</button>"),a.put("components/footer/footer.html",'<div class=container><p>Angular Fullstack v3.6.1 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></div>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div></div><div class=modal-footer><button ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button></div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarController><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="nav.isCollapsed = !nav.isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href=/ class=navbar-brand>pedaleswitch</a></div><div uib-collapse=nav.isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in nav.menu" ui-sref-active=active><a ui-sref={{item.state}}>{{item.title}}</a></li><li ng-show=nav.isAdmin() ui-sref-active=active><a ui-sref=admin>Admin</a></li></ul><ul class="nav navbar-nav navbar-right"><li ng-hide=nav.isLoggedIn() ui-sref-active=active><a ui-sref=signup>Sign up</a></li><li ng-hide=nav.isLoggedIn() ui-sref-active=active><a ui-sref=login>Login</a></li><li ng-show=nav.isLoggedIn()><p class=navbar-text>Hello {{ nav.getCurrentUser().name }}</p></li><li ng-show=nav.isLoggedIn() ui-sref-active=active><a ui-sref=settings><span class="glyphicon glyphicon-cog"></span></a></li><li ng-show=nav.isLoggedIn()><a ui-sref=logout>Logout</a></li></ul></div></div></div>')}]);